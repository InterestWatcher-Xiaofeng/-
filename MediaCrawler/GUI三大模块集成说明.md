# 🎨 GUI三大核心模块集成说明

> 红枫工具箱-数据采集版 三大核心模块使用指南

---

## 🎯 三大核心模块

### 模块1: 🔍 多关键词搜索模式

**功能:**
- 输入多个关键词 (每行一个)
- 自动搜索每个关键词
- 批量收集视频链接
- 批量抓取评论数据

**技术方案:**
- 抖音: RPA混合模式 (RPA搜索 + Detail抓取)
- 其他平台: Search API模式

---

### 模块2: 📄 指定多链接评论提取模式

**功能:**
- 输入视频链接或ID
- 批量抓取评论数据
- 支持多种链接格式

**技术方案:**
- Detail模式

---

### 模块3: 👤 主页所有视频评论提取模式

**功能:**
- 输入创作者ID或主页链接
- 自动获取所有视频
- 批量抓取评论数据

**技术方案:**
- Creator模式

---

## 📋 GUI界面说明

### 平台配置标签页

**选择平台:**
```
🔴 小红书 (xhs)
🎵 抖音 (dy)
⚡ 快手 (ks)
📺 B站 (bili)
📱 微博 (wb)
💬 贴吧 (tieba)
📖 知乎 (zhihu)
```

**选择采集模式:**

#### 模式1: 🔍 关键词搜索

**界面:**
```
关键词 (支持批量):
┌─────────────────────────────┐
│ 东方女孩                     │
│ 程序员                       │
│ AI技术                       │
└─────────────────────────────┘
💡 每行一组关键词，自动批量采集
```

**使用方法:**
1. 选择"🔍 关键词搜索"
2. 在文本框中输入关键词 (每行一个)
3. 点击"🚀 开始采集"

**自动执行:**
- 遍历每个关键词
- 搜索并收集视频链接
- 批量抓取评论数据

---

#### 模式2: 📄 指定内容详情

**界面:**
```
链接/ID: [请输入内容链接或ID]
```

**使用方法:**
1. 选择"📄 指定内容详情"
2. 输入视频链接或ID
3. 点击"🚀 开始采集"

**支持的链接格式:**
```
# 抖音
https://www.douyin.com/video/7525538910311632128
https://v.douyin.com/drIPtQ_WPWY/
7525538910311632128

# 小红书
https://www.xiaohongshu.com/explore/...
xsec_token=...

# B站
https://www.bilibili.com/video/BV1...
BV1...
```

---

#### 模式3: 👤 创作者主页

**界面:**
```
创作者: [请输入创作者链接或ID]
```

**使用方法:**
1. 选择"👤 创作者主页"
2. 输入创作者链接或ID
3. 点击"🚀 开始采集"

**支持的格式:**
```
# 抖音
https://www.douyin.com/user/MS4wLjABAAAA...
MS4wLjABAAAA...

# 小红书
https://www.xiaohongshu.com/user/profile/...
用户ID

# B站
https://space.bilibili.com/123456
123456
```

---

## 🚀 使用流程

### 完整流程

```
第1步: 选择平台
  → 点击平台图标 (如: 🎵 抖音)

第2步: 选择模式
  → 🔍 关键词搜索
  → 📄 指定内容详情
  → 👤 创作者主页

第3步: 输入参数
  → 关键词/链接/创作者ID

第4步: 配置设置
  → 采集设置标签页
  → 设置视频数量、评论数量等

第5步: 登录平台
  → 登录管理标签页
  → 点击"开始登录"
  → 扫码登录

第6步: 开始采集
  → 点击"🚀 开始采集"
  → 等待完成

第7步: 查看结果
  → 结果查看标签页
  → 打开数据目录
```

---

## 🎯 抖音平台特殊说明

### 模块1: 多关键词搜索 (RPA混合模式)

**为什么使用RPA模式?**
- 抖音Search API被反爬虫拦截
- RPA模式模拟人工操作
- 绕过API限制

**工作流程:**
```
输入关键词列表
    ↓
遍历每个关键词
    ↓
RPA搜索关键词 (打开浏览器)
    ↓
滚动收集视频链接
    ↓
保存链接到配置
    ↓
调用Detail模式抓取评论
    ↓
保存CSV数据
```

**注意事项:**
- 第一次使用需要登录
- 浏览器会自动打开
- 等待RPA搜索完成
- 不要手动关闭浏览器

---

### 模块2: 指定链接 (Detail模式)

**工作流程:**
```
输入视频链接
    ↓
访问视频页面
    ↓
抓取视频信息
    ↓
抓取评论数据
    ↓
保存CSV数据
```

**注意事项:**
- 支持多种链接格式
- 稳定可靠
- 推荐使用

---

### 模块3: 主页视频 (Creator模式)

**工作流程:**
```
输入创作者ID
    ↓
访问创作者主页
    ↓
获取所有视频列表
    ↓
批量抓取评论
    ↓
保存CSV数据
```

**注意事项:**
- 需要创作者ID
- 会抓取所有视频
- 耗时较长

---

## 📊 采集设置说明

### 数量控制

```
📊 内容数量: [20]
  → 每个关键词获取的视频数量
  → 或创作者主页的视频数量

💬 评论数量: [100]
  → 每个视频抓取的评论数量

📄 起始页: [1]
  → 从第几页开始抓取
```

---

### 评论设置

```
☑️ 抓取评论
  → 是否抓取评论数据

☑️ 抓取子评论
  → 是否抓取二级评论

☑️ 生成词云图
  → 是否生成评论词云图
```

---

### 媒体下载

```
☑️ 下载图片
  → 是否下载视频封面图

☑️ 下载视频
  → 是否下载视频文件
```

---

## 📁 输出数据说明

### 数据目录结构

```
data/
├── douyin/
│   ├── links/
│   │   ├── video_links_东方女孩_*.txt
│   │   └── video_links_东方女孩_*.json
│   ├── csv/
│   │   ├── detail_contents_*.csv  (视频信息)
│   │   └── detail_comments_*.csv  (评论数据)
│   └── json/
│       ├── detail_contents_*.json
│       └── detail_comments_*.json
├── xhs/
│   └── ...
└── ...
```

---

### CSV数据字段

**视频信息 (detail_contents_*.csv):**
```csv
note_id,title,desc,create_time,user_id,nickname,avatar,liked_count,collected_count,comment_count,share_count
```

**评论数据 (detail_comments_*.csv):**
```csv
comment_id,content,nickname,user_id,like_count,create_time,ip_location,sub_comment_count
```

---

## 💡 使用技巧

### 技巧1: 批量关键词搜索

**场景:** 研究多个话题

**操作:**
```
1. 选择"🔍 关键词搜索"
2. 输入多个关键词:
   东方女孩
   程序员
   AI技术
3. 设置每个关键词20个视频
4. 设置每个视频100条评论
5. 点击"🚀 开始采集"
```

**结果:**
```
3个关键词 × 20个视频 = 60个视频
60个视频 × 100条评论 = 6000条评论
```

---

### 技巧2: 精确分析特定视频

**场景:** 分析热门视频评论

**操作:**
```
1. 选择"📄 指定内容详情"
2. 输入视频链接
3. 设置评论数量200
4. 点击"🚀 开始采集"
```

**结果:**
```
1个视频 × 200条评论 = 200条评论
```

---

### 技巧3: 分析创作者粉丝

**场景:** 研究创作者粉丝画像

**操作:**
```
1. 选择"👤 创作者主页"
2. 输入创作者ID
3. 设置评论数量100
4. 点击"🚀 开始采集"
```

**结果:**
```
假设创作者有50个视频
50个视频 × 100条评论 = 5000条评论
```

---

## ⚙️ 高级功能

### 功能1: 词云图生成

**操作:**
```
1. 完成数据采集
2. 点击"📊 生成词云图"
3. 查看词云图文件
```

**输出:**
```
data/douyin/wordcloud/
└── wordcloud_*.png
```

---

### 功能2: 数据分析

**操作:**
```
1. 完成数据采集
2. 点击"📈 数据分析"
3. 查看分析报告
```

**分析内容:**
- 评论数量统计
- 高频词汇分析
- 用户活跃度分析
- IP归属地分布

---

### 功能3: 批量导出

**操作:**
```
1. 完成数据采集
2. 输出设置标签页
3. 选择保存格式 (CSV/JSON/DB)
4. 点击"📁 打开数据目录"
```

---

## 🎉 总结

### GUI三大模块完整性

| 模块 | GUI界面 | 后端实现 | 状态 |
|------|---------|---------|------|
| **模块1: 多关键词搜索** | ✅ 已有 | ✅ RPA混合模式 | ✅ 完整 |
| **模块2: 指定链接提取** | ✅ 已有 | ✅ Detail模式 | ✅ 完整 |
| **模块3: 主页视频提取** | ✅ 已有 | ✅ Creator模式 | ✅ 完整 |

---

### 核心优势

1. **✅ 图形界面友好**
   - 无需编写代码
   - 可视化操作
   - 实时进度显示

2. **✅ 功能完整**
   - 三大核心模块
   - 多平台支持
   - 批量处理

3. **✅ 自动化程度高**
   - 一键采集
   - 自动登录
   - 自动保存

4. **✅ 数据完整可靠**
   - 完整评论数据
   - 多种导出格式
   - 数据分析功能

---

**🎊 GUI三大核心模块已完整集成,使用简单,功能强大!**

**💡 建议:** 
- 抖音平台优先使用"🔍 关键词搜索"模式 (RPA混合模式)
- 其他平台可以直接使用Search API模式
- 如果Search API失败,可以使用"📄 指定内容详情"模式

