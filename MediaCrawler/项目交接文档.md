# ğŸ çº¢æ«å·¥å…·ç®± - é¡¹ç›®äº¤æ¥æ–‡æ¡£

> **æ–‡æ¡£ç‰ˆæœ¬:** V1.2.4  
> **æœ€åæ›´æ–°:** 2025-11-03  
> **é¡¹ç›®è´Ÿè´£äºº:** yufeng (InterestWatcher-Xiaofeng)  
> **GitHubä»“åº“:** https://github.com/InterestWatcher-Xiaofeng/-

---

## ğŸ“‹ ç›®å½•

1. [é¡¹ç›®æ¦‚è¿°](#é¡¹ç›®æ¦‚è¿°)
2. [é¡¹ç›®èƒŒæ™¯ä¸ç›®çš„](#é¡¹ç›®èƒŒæ™¯ä¸ç›®çš„)
3. [å½“å‰åŠŸèƒ½æ¸…å•](#å½“å‰åŠŸèƒ½æ¸…å•)
4. [æŠ€æœ¯æ¶æ„](#æŠ€æœ¯æ¶æ„)
5. [æ ¸å¿ƒå‚æ•°é…ç½®](#æ ¸å¿ƒå‚æ•°é…ç½®)
6. [ç”¨æˆ·éœ€æ±‚è®°å½•](#ç”¨æˆ·éœ€æ±‚è®°å½•)
7. [å¼€å‘å†å²ä¸ç‰ˆæœ¬æ¼”è¿›](#å¼€å‘å†å²ä¸ç‰ˆæœ¬æ¼”è¿›)
8. [ä»£ç ç»“æ„è¯´æ˜](#ä»£ç ç»“æ„è¯´æ˜)
9. [å…³é”®åŠŸèƒ½å®ç°](#å…³é”®åŠŸèƒ½å®ç°)
10. [æµ‹è¯•ä¸éªŒè¯](#æµ‹è¯•ä¸éªŒè¯)
11. [å·²çŸ¥é—®é¢˜ä¸é™åˆ¶](#å·²çŸ¥é—®é¢˜ä¸é™åˆ¶)
12. [åç»­å¼€å‘å»ºè®®](#åç»­å¼€å‘å»ºè®®)
13. [å¿«é€Ÿä¸Šæ‰‹æŒ‡å—](#å¿«é€Ÿä¸Šæ‰‹æŒ‡å—)

---

## ğŸ“– é¡¹ç›®æ¦‚è¿°

### é¡¹ç›®åç§°
**çº¢æ«å·¥å…·ç®± - æ•°æ®é‡‡é›†ç‰ˆ** (MediaCrawler GUI)

### é¡¹ç›®å®šä½
åŸºäºå¼€æºé¡¹ç›® [MediaCrawler](https://github.com/NanmiCoder/MediaCrawler) çš„å®šåˆ¶åŒ–GUIå·¥å…·ï¼Œä¸“æ³¨äºç¤¾äº¤åª’ä½“è¯„è®ºæ•°æ®é‡‡é›†ã€‚

### æ ¸å¿ƒä»·å€¼
- ğŸ¯ **ç®€åŒ–æ“ä½œ:** å°†å‘½ä»¤è¡Œå·¥å…·è½¬åŒ–ä¸ºå¯è§†åŒ–GUIç•Œé¢
- ğŸ“Š **æ•°æ®é‡‡é›†:** æ‰¹é‡é‡‡é›†ç¤¾äº¤åª’ä½“è¯„è®ºæ•°æ®
- ğŸ”„ **æ‰¹é‡å¤„ç†:** æ”¯æŒå¤šå…³é”®è¯ã€å¤šè§†é¢‘æ‰¹é‡é‡‡é›†
- ğŸ’¾ **æ•°æ®å¯¼å‡º:** è‡ªåŠ¨ç”ŸæˆCSVæ ¼å¼æ•°æ®æ–‡ä»¶

### ç›®æ ‡ç”¨æˆ·
- æ•°æ®åˆ†æå¸ˆ
- å¸‚åœºç ”ç©¶äººå‘˜
- å†…å®¹è¿è¥äººå‘˜
- å­¦æœ¯ç ”ç©¶äººå‘˜

---

## ğŸ¯ é¡¹ç›®èƒŒæ™¯ä¸ç›®çš„

### é¡¹ç›®èµ·æº
**æ—¶é—´:** 2025å¹´10æœˆ  
**èƒŒæ™¯:** ç”¨æˆ·éœ€è¦ä»æŠ–éŸ³ã€å°çº¢ä¹¦ç­‰å¹³å°æ‰¹é‡é‡‡é›†è¯„è®ºæ•°æ®ç”¨äºåˆ†æ

**åŸå§‹éœ€æ±‚:**
> "æˆ‘éœ€è¦ä¸€ä¸ªå·¥å…·ï¼Œèƒ½å¤Ÿæ‰¹é‡é‡‡é›†æŠ–éŸ³è§†é¢‘çš„è¯„è®ºï¼Œå¹¶å¯¼å‡ºä¸ºExcelè¡¨æ ¼ï¼Œæ–¹ä¾¿æˆ‘åšæ•°æ®åˆ†æã€‚"

### æ ¸å¿ƒç—›ç‚¹
1. **åŸç‰ˆMediaCrawleræ˜¯å‘½ä»¤è¡Œå·¥å…·** - éœ€è¦ç¼–ç¨‹åŸºç¡€ï¼Œæ™®é€šç”¨æˆ·éš¾ä»¥ä½¿ç”¨
2. **é…ç½®å¤æ‚** - éœ€è¦æ‰‹åŠ¨ä¿®æ”¹é…ç½®æ–‡ä»¶
3. **æ‰¹é‡æ“ä½œå›°éš¾** - æ¯æ¬¡åªèƒ½å¤„ç†ä¸€ä¸ªå…³é”®è¯
4. **æ–‡ä»¶ç®¡ç†æ··ä¹±** - å¤šæ¬¡é‡‡é›†ä¼šè¦†ç›–ä¹‹å‰çš„æ•°æ®
5. **è¿›åº¦ä¸å¯è§** - ä¸çŸ¥é“é‡‡é›†è¿›åº¦ï¼Œæ— æ³•é¢„ä¼°æ—¶é—´

### è§£å†³æ–¹æ¡ˆ
å¼€å‘GUIç•Œé¢ï¼Œå°†å¤æ‚çš„é…ç½®å’Œæ“ä½œå¯è§†åŒ–ï¼Œè®©éæŠ€æœ¯ç”¨æˆ·ä¹Ÿèƒ½è½»æ¾ä½¿ç”¨ã€‚

---

## âœ¨ å½“å‰åŠŸèƒ½æ¸…å•

### æ ¸å¿ƒåŠŸèƒ½ (å·²å®ç° âœ…)

#### 1. å¹³å°æ”¯æŒ
- âœ… **æŠ–éŸ³ (Douyin)** - ä¸»è¦æ”¯æŒå¹³å°
- âœ… **å°çº¢ä¹¦ (XHS)** - å®Œæ•´æ”¯æŒ
- âœ… **Bç«™ (Bilibili)** - å®Œæ•´æ”¯æŒ
- âœ… **çŸ¥ä¹ (Zhihu)** - å®Œæ•´æ”¯æŒ

**æ³¨æ„:** GUIåªæ˜¾ç¤ºè¿™4ä¸ªå¹³å°ï¼Œå…¶ä»–å¹³å°(å¿«æ‰‹ã€å¾®åšã€è´´å§)å·²ç§»é™¤ã€‚

#### 2. é‡‡é›†æ¨¡å¼
- âœ… **å…³é”®è¯æœç´¢æ¨¡å¼** - æœç´¢å…³é”®è¯ï¼Œé‡‡é›†ç›¸å…³è§†é¢‘è¯„è®º
- âœ… **æŒ‡å®šè§†é¢‘é“¾æ¥æ¨¡å¼** - è¾“å…¥è§†é¢‘é“¾æ¥ï¼Œé‡‡é›†è¯¥è§†é¢‘è¯„è®º
- âœ… **åˆ›ä½œè€…ä¸»é¡µæ¨¡å¼** - è¾“å…¥åˆ›ä½œè€…ä¸»é¡µé“¾æ¥ï¼Œé‡‡é›†å…¶æ‰€æœ‰è§†é¢‘è¯„è®º

#### 3. æ‰¹é‡å¤„ç†
- âœ… **æ‰¹é‡å…³é”®è¯æœç´¢** - å¤šè¡Œè¾“å…¥ï¼Œè‡ªåŠ¨ä¾æ¬¡é‡‡é›†
- âœ… **æ‰¹é‡è§†é¢‘é“¾æ¥** - å¤šä¸ªé“¾æ¥ï¼Œæ‰¹é‡é‡‡é›†
- âœ… **è¿›åº¦æ˜¾ç¤º** - å®æ—¶æ˜¾ç¤ºé‡‡é›†è¿›åº¦å’Œå½“å‰è§†é¢‘æ ‡é¢˜

#### 4. ç™»å½•ç®¡ç†
- âœ… **æ‰«ç ç™»å½•** - æ”¯æŒå„å¹³å°æ‰«ç ç™»å½•
- âœ… **ç™»å½•çŠ¶æ€ä¿å­˜** - è‡ªåŠ¨ä¿å­˜ç™»å½•ä¿¡æ¯
- âœ… **è‡ªåŠ¨æ¢å¤ç™»å½•** - ä¸‹æ¬¡å¯åŠ¨è‡ªåŠ¨æ¢å¤ç™»å½•çŠ¶æ€
- âœ… **ç™»å½•çŠ¶æ€æ£€æµ‹** - å¯åŠ¨æ—¶è‡ªåŠ¨æ£€æµ‹ç™»å½•æœ‰æ•ˆæ€§

#### 5. æ•°æ®å¯¼å‡º
- âœ… **CSVæ ¼å¼** - ä¸»è¦å¯¼å‡ºæ ¼å¼
- âœ… **JSONæ ¼å¼** - æ”¯æŒJSONå¯¼å‡º
- âœ… **è‡ªå®šä¹‰è¾“å‡ºç›®å½•** - å¯æŒ‡å®šä¿å­˜ä½ç½®
- âœ… **æ™ºèƒ½æ–‡ä»¶å‘½å** - å…³é”®è¯_æ—¶é—´æˆ³_ç±»å‹.csv

#### 6. ç”¨æˆ·ä½“éªŒ
- âœ… **åŸç¥é£æ ¼å›¾æ ‡** - ä½¿ç”¨ç”¨æˆ·æŒ‡å®šçš„åŸç¥å›¾ç‰‡ä½œä¸ºè½¯ä»¶å›¾æ ‡
- âœ… **åœæ­¢åŠŸèƒ½** - ä¸€é”®åœæ­¢é•¿æ—¶é—´é‡‡é›†ä»»åŠ¡
- âœ… **æ—¥å¿—è®°å½•** - è¯¦ç»†çš„æ“ä½œæ—¥å¿—
- âœ… **é”™è¯¯æç¤º** - å‹å¥½çš„é”™è¯¯æç¤ºä¿¡æ¯

### åŠŸèƒ½é™åˆ¶ (å·²æ˜ç¡® âš ï¸)

#### 1. åªé‡‡é›†è¯„è®º
- âœ… **è¯„è®ºæ•°æ®** - å®Œæ•´é‡‡é›†
- âŒ **è§†é¢‘å†…å®¹** - å·²ç¦ç”¨(ç”¨æˆ·ä¸éœ€è¦)
- âŒ **åˆ›ä½œè€…ä¿¡æ¯** - å·²ç¦ç”¨(ç”¨æˆ·ä¸éœ€è¦)

#### 2. å¹³å°é™åˆ¶
- âœ… **4ä¸ªæ ¸å¿ƒå¹³å°** - æŠ–éŸ³ã€å°çº¢ä¹¦ã€Bç«™ã€çŸ¥ä¹
- âŒ **å¿«æ‰‹ã€å¾®åšã€è´´å§** - å·²ä»GUIç§»é™¤

---

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### æŠ€æœ¯æ ˆ

#### å‰ç«¯ç•Œé¢
- **CustomTkinter** - ç°ä»£åŒ–çš„Tkinter UIåº“
- **Pillow (PIL)** - å›¾åƒå¤„ç†(å›¾æ ‡ç”Ÿæˆ)

#### åç«¯çˆ¬è™«
- **Playwright** - æµè§ˆå™¨è‡ªåŠ¨åŒ–
- **httpx** - å¼‚æ­¥HTTPå®¢æˆ·ç«¯
- **asyncio** - å¼‚æ­¥ç¼–ç¨‹

#### æ•°æ®å¤„ç†
- **aiofiles** - å¼‚æ­¥æ–‡ä»¶æ“ä½œ
- **csv** - CSVæ–‡ä»¶å¤„ç†
- **json** - JSONæ•°æ®å¤„ç†

#### å…¶ä»–
- **jieba** - ä¸­æ–‡åˆ†è¯(è¯äº‘åŠŸèƒ½)
- **pathlib** - è·¯å¾„å¤„ç†

### æ¶æ„è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    GUIç•Œé¢å±‚ (gui_app.py)                â”‚
â”‚  - ç”¨æˆ·äº¤äº’                                              â”‚
â”‚  - å‚æ•°é…ç½®                                              â”‚
â”‚  - è¿›åº¦æ˜¾ç¤º                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ç»Ÿä¸€æµè§ˆå™¨ç®¡ç†å±‚ (browser_manager.py)        â”‚
â”‚  - æµè§ˆå™¨å®ä¾‹ç®¡ç†                                        â”‚
â”‚  - ç™»å½•çŠ¶æ€ç®¡ç†                                          â”‚
â”‚  - Cookieç®¡ç†                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              å¹³å°çˆ¬è™«å±‚ (media_platform/)                â”‚
â”‚  â”œâ”€ douyin/     - æŠ–éŸ³çˆ¬è™«                              â”‚
â”‚  â”œâ”€ xhs/        - å°çº¢ä¹¦çˆ¬è™«                            â”‚
â”‚  â”œâ”€ bilibili/   - Bç«™çˆ¬è™«                               â”‚
â”‚  â””â”€ zhihu/      - çŸ¥ä¹çˆ¬è™«                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              æ•°æ®å­˜å‚¨å±‚ (store/)                         â”‚
â”‚  - CSVå­˜å‚¨                                              â”‚
â”‚  - JSONå­˜å‚¨                                             â”‚
â”‚  - æ–‡ä»¶å‘½åç®¡ç†                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å…³é”®è®¾è®¡æ¨¡å¼

#### 1. å·¥å‚æ¨¡å¼
```python
# å¹³å°çˆ¬è™«å·¥å‚
def create_crawler(platform: str):
    if platform == "dy":
        return DouyinCrawler()
    elif platform == "xhs":
        return XHSCrawler()
    # ...
```

#### 2. å•ä¾‹æ¨¡å¼
```python
# æµè§ˆå™¨ç®¡ç†å™¨å•ä¾‹
class BrowserManager:
    _instance = None
    
    def __new__(cls):
        if cls._instance is None:
            cls._instance = super().__new__(cls)
        return cls._instance
```

#### 3. è§‚å¯Ÿè€…æ¨¡å¼
```python
# è¿›åº¦å›è°ƒ
def on_progress(current, total, video_title):
    # æ›´æ–°GUIè¿›åº¦æ˜¾ç¤º
    pass
```

---

## âš™ï¸ æ ¸å¿ƒå‚æ•°é…ç½®

### é…ç½®æ–‡ä»¶ä½ç½®
- **ä¸»é…ç½®:** `config/base_config.py`
- **å¹³å°é…ç½®:** `config/douyin_config.py`, `config/xhs_config.py` ç­‰

### å…³é”®å‚æ•°è¯´æ˜

#### 1. é‡‡é›†æ¨¡å¼å‚æ•°

```python
# config/base_config.py

# é‡‡é›†æ¨¡å¼: search(å…³é”®è¯æœç´¢) / detail(æŒ‡å®šé“¾æ¥) / creator(åˆ›ä½œè€…ä¸»é¡µ)
CRAWLER_TYPE = "search"

# å…³é”®è¯åˆ—è¡¨(å…³é”®è¯æœç´¢æ¨¡å¼)
KEYWORDS = "ç¾é£Ÿ æ¢åº—"

# è§†é¢‘é“¾æ¥åˆ—è¡¨(æŒ‡å®šé“¾æ¥æ¨¡å¼)
DY_SPECIFIED_ID_LIST = [
    "https://www.douyin.com/video/7XXX",
    "https://www.douyin.com/video/7YYY"
]

# åˆ›ä½œè€…IDåˆ—è¡¨(åˆ›ä½œè€…ä¸»é¡µæ¨¡å¼)
DY_CREATOR_ID_LIST = ["MS4wLjABAAAAXXX"]
```

#### 2. é‡‡é›†æ•°é‡å‚æ•°

```python
# æ¯ä¸ªå…³é”®è¯é‡‡é›†çš„è§†é¢‘æ•°é‡
CRAWLER_MAX_NOTES_COUNT = 10

# æ¯ä¸ªè§†é¢‘é‡‡é›†çš„è¯„è®ºæ•°é‡
MAX_COMMENTS_PER_POST = 100

# æ˜¯å¦é‡‡é›†äºŒçº§è¯„è®º
ENABLE_GET_SUB_COMMENTS = True
```

#### 3. æ•°æ®ä¿å­˜å‚æ•°

```python
# ä¿å­˜æ ¼å¼: csv / json / db
SAVE_DATA_OPTION = "csv"

# è‡ªå®šä¹‰è¾“å‡ºç›®å½•(å¯é€‰)
CUSTOM_OUTPUT_DIR = ""

# æ˜¯å¦ä¿å­˜è¯„è®º
ENABLE_GET_COMMENTS = True

# æ˜¯å¦ä¿å­˜å†…å®¹(å·²ç¦ç”¨)
ENABLE_GET_CONTENTS = False
```

#### 4. æµè§ˆå™¨å‚æ•°

```python
# æ˜¯å¦ä½¿ç”¨æ— å¤´æ¨¡å¼
HEADLESS = False

# æµè§ˆå™¨ç±»å‹: chromium / firefox / webkit
BROWSER_TYPE = "chromium"

# ç”¨æˆ·æ•°æ®ç›®å½•
USER_DATA_DIR = "./browser_data"
```

#### 5. ç™»å½•å‚æ•°

```python
# ç™»å½•æ–¹å¼: qrcode(æ‰«ç ) / cookie(Cookie)
LOGIN_TYPE = "qrcode"

# Cookieæœ‰æ•ˆæœŸ(å¤©)
COOKIE_EXPIRE_DAYS = 30
```

---

## ğŸ“ ç”¨æˆ·éœ€æ±‚è®°å½•

### éœ€æ±‚æ¼”è¿›å†å²

#### é˜¶æ®µ1: åˆå§‹éœ€æ±‚ (V1.0.0)
**æ—¶é—´:** 2025-10-25  
**éœ€æ±‚:**
1. èƒ½å¤Ÿé‡‡é›†æŠ–éŸ³è§†é¢‘è¯„è®º
2. å¯¼å‡ºä¸ºExcelè¡¨æ ¼
3. æœ‰ç®€å•çš„GUIç•Œé¢

**å®ç°:**
- âœ… åŸºç¡€GUIç•Œé¢
- âœ… æŠ–éŸ³è¯„è®ºé‡‡é›†
- âœ… CSVå¯¼å‡º(Excelå¯æ‰“å¼€)

#### é˜¶æ®µ2: æ‰¹é‡å¤„ç†éœ€æ±‚ (V1.2.0)
**æ—¶é—´:** 2025-10-28  
**éœ€æ±‚:**
1. æ”¯æŒæ‰¹é‡å…³é”®è¯æœç´¢
2. æ˜¾ç¤ºé‡‡é›†è¿›åº¦
3. æ–‡ä»¶ä¸è¦è¦†ç›–

**å®ç°:**
- âœ… å¤šè¡Œå…³é”®è¯è¾“å…¥
- âœ… å®æ—¶è¿›åº¦æ˜¾ç¤º
- âœ… æ–‡ä»¶åæ·»åŠ æ—¶é—´æˆ³

#### é˜¶æ®µ3: ç”¨æˆ·ä½“éªŒä¼˜åŒ– (V1.2.3)
**æ—¶é—´:** 2025-11-01  
**éœ€æ±‚:**
1. ä¿®å¤è¶…æ—¶é—®é¢˜
2. ä¼˜åŒ–è¿›åº¦æ˜¾ç¤º
3. æ˜¾ç¤ºè§†é¢‘æ ‡é¢˜

**å®ç°:**
- âœ… å¢åŠ è¶…æ—¶æ—¶é—´åˆ°60ç§’
- âœ… è¿›åº¦æ¡æ˜¾ç¤ºå½“å‰/æ€»æ•°
- âœ… çŠ¶æ€æ æ˜¾ç¤ºè§†é¢‘æ ‡é¢˜

#### é˜¶æ®µ4: ç•Œé¢ç²¾ç®€ä¸ä¸ªæ€§åŒ– (V1.2.4)
**æ—¶é—´:** 2025-11-03  
**éœ€æ±‚:**
1. GUIåªä¿ç•™4ä¸ªå¹³å°
2. æ·»åŠ åœæ­¢åŠŸèƒ½
3. ä½¿ç”¨åŸç¥å›¾æ ‡
4. æ–‡ä»¶å‘½åæ”¹ä¸º"å…³é”®è¯_æ—¶é—´æˆ³"

**å®ç°:**
- âœ… ç§»é™¤å¿«æ‰‹ã€å¾®åšã€è´´å§
- âœ… åœæ­¢åŠŸèƒ½å·²å­˜åœ¨(ç¡®è®¤)
- âœ… åŸç¥é£æ ¼å›¾æ ‡
- âœ… æ–‡ä»¶å‘½åä¼˜åŒ–

### ç”¨æˆ·åå¥½è®¾ç½®

#### 1. ç™»å½•ä¿¡æ¯ç®¡ç†
**éœ€æ±‚:** "è®°ä½æˆ‘çš„ç™»å½•ä¿¡æ¯,åº”ç”¨äºåç»­æ‰€æœ‰æµ‹è¯•"  
**å®ç°:** 
- ç™»å½•ä¿¡æ¯è‡ªåŠ¨ä¿å­˜åˆ° `login_data/` ç›®å½•
- ä¸‹æ¬¡å¯åŠ¨è‡ªåŠ¨æ¢å¤ç™»å½•çŠ¶æ€
- 30å¤©æœ‰æ•ˆæœŸ

#### 2. æ–‡ä»¶å‘½åè§„åˆ™
**éœ€æ±‚:** "æœç´¢å…³é”®è¯è¾“å‡ºçš„æ–‡ä»¶å‘½åè§„åˆ™ä¸º'å…³é”®è¯+æ—¶é—´'"  
**å®ç°:**
- å…³é”®è¯æœç´¢: `å…³é”®è¯_æ—¶é—´æˆ³_è¯„è®º.csv`
- å¤šé“¾æ¥æ¨¡å¼: `æ—¶é—´æˆ³_Næ¡è§†é¢‘_è¯„è®º.csv`
- åˆ›ä½œè€…æ¨¡å¼: `åšä¸»æ˜µç§°_Mæ¡è§†é¢‘_è¯„è®º.csv`

#### 3. å¹³å°é€‰æ‹©
**éœ€æ±‚:** "GUIç•Œé¢åªä¿ç•™å°çº¢ä¹¦æŠ–éŸ³Bç«™å’ŒçŸ¥ä¹çš„é€‰æ‹©ç•Œé¢"  
**å®ç°:**
- åªæ˜¾ç¤º4ä¸ªæ ¸å¿ƒå¹³å°
- å…¶ä»–å¹³å°ä»£ç ä¿ç•™ä½†ä¸æ˜¾ç¤º

#### 4. è½¯ä»¶å›¾æ ‡
**éœ€æ±‚:** "ç»™è½¯ä»¶å¢åŠ å›¾æ ‡,ä½¿ç”¨åŸç¥çš„å›¾ç‰‡"  
**å®ç°:**
- ä½¿ç”¨ç”¨æˆ·æŒ‡å®šçš„åŸç¥å›¾ç‰‡
- PNGè½¬ICOå¤šå°ºå¯¸å›¾æ ‡
- çª—å£å’Œä»»åŠ¡æ éƒ½æ˜¾ç¤º

---

## ğŸ“š å¼€å‘å†å²ä¸ç‰ˆæœ¬æ¼”è¿›

### ç‰ˆæœ¬æ—¶é—´çº¿

```
V1.0.0 (2025-10-25) - åˆå§‹ç‰ˆæœ¬
    â†“
V1.1.0 (2025-10-26) - åŸºç¡€åŠŸèƒ½å®Œå–„
    â†“
V1.2.0 (2025-10-28) - æ‰¹é‡å¤„ç†æ”¯æŒ
    â†“
V1.2.1 (2025-10-29) - æ–‡ä»¶å‘½åä¼˜åŒ–
    â†“
V1.2.2 (2025-10-30) - æ–‡ä»¶ç®¡ç†ä¿®å¤
    â†“
V1.2.3 (2025-11-01) - è¶…æ—¶ä¿®å¤+è¿›åº¦ä¼˜åŒ–
    â†“
V1.2.4 (2025-11-03) - GUIç²¾ç®€+å›¾æ ‡+å‘½åä¼˜åŒ– â† å½“å‰ç‰ˆæœ¬
```

### è¯¦ç»†ç‰ˆæœ¬è¯´æ˜

#### V1.2.4 (å½“å‰ç‰ˆæœ¬)
**å‘å¸ƒæ—¥æœŸ:** 2025-11-03  
**ç±»å‹:** ç”¨æˆ·ä½“éªŒä¼˜åŒ–

**ä¸»è¦æ›´æ–°:**
1. GUIç•Œé¢ç²¾ç®€ - åªä¿ç•™4ä¸ªæ ¸å¿ƒå¹³å°
2. åŸç¥é£æ ¼å›¾æ ‡ - ä½¿ç”¨ç”¨æˆ·æŒ‡å®šå›¾ç‰‡
3. æ–‡ä»¶å‘½åä¼˜åŒ– - å…³é”®è¯_æ—¶é—´æˆ³_ç±»å‹.csv

**ä¿®æ”¹æ–‡ä»¶:**
- `gui_app.py` - ç²¾ç®€å¹³å°åˆ—è¡¨,æ·»åŠ å›¾æ ‡è®¾ç½®
- `tools/async_file_writer.py` - ä¼˜åŒ–æ–‡ä»¶å‘½åè§„åˆ™
- `create_icon.py` - PNGè½¬ICOè„šæœ¬
- `icon.ico` - åŸç¥å›¾æ ‡

**Gitæäº¤:** `2e61222`

#### V1.2.3
**å‘å¸ƒæ—¥æœŸ:** 2025-11-01  
**ç±»å‹:** Bugä¿®å¤ + åŠŸèƒ½ä¼˜åŒ–

**ä¸»è¦æ›´æ–°:**
1. ä¿®å¤è¶…æ—¶é—®é¢˜ - å¢åŠ è¶…æ—¶æ—¶é—´åˆ°60ç§’
2. æ–°å¢è¿›åº¦æ˜¾ç¤º - æ˜¾ç¤ºå½“å‰è§†é¢‘æ ‡é¢˜å’Œè¿›åº¦
3. ä¼˜åŒ–ç”¨æˆ·ä½“éªŒ - æ›´å‹å¥½çš„æç¤ºä¿¡æ¯

**ä¿®æ”¹æ–‡ä»¶:**
- `media_platform/douyin/core.py` - å¢åŠ è¶…æ—¶æ—¶é—´
- `gui_app.py` - æ·»åŠ è¿›åº¦å›è°ƒæ˜¾ç¤º

**Gitæäº¤:** `a03cf18`

#### V1.2.2
**å‘å¸ƒæ—¥æœŸ:** 2025-10-30  
**ç±»å‹:** Bugä¿®å¤

**ä¸»è¦æ›´æ–°:**
1. ä¿®å¤æ–‡ä»¶è¦†ç›–é—®é¢˜ - æ–‡ä»¶åæ·»åŠ æ—¶é—´æˆ³
2. è‡ªåŠ¨æ¸…ç©ºè¾“å…¥æ¡† - é‡‡é›†å®Œæˆåæ¸…ç©º

**ä¿®æ”¹æ–‡ä»¶:**
- `tools/async_file_writer.py` - æ·»åŠ æ—¶é—´æˆ³
- `gui_app.py` - æ·»åŠ æ¸…ç©ºé€»è¾‘

#### V1.2.1
**å‘å¸ƒæ—¥æœŸ:** 2025-10-29  
**ç±»å‹:** åŠŸèƒ½ä¼˜åŒ–

**ä¸»è¦æ›´æ–°:**
1. æ–‡ä»¶å‘½åä¼˜åŒ– - å¹³å°_å…³é”®è¯_ç±»å‹.æ ¼å¼
2. è¿›åº¦å›è°ƒæœºåˆ¶ - å®æ—¶æ˜¾ç¤ºè¿›åº¦

**ä¿®æ”¹æ–‡ä»¶:**
- `tools/async_file_writer.py` - æ–°å‘½åè§„åˆ™
- `gui_app.py` - è¿›åº¦æ˜¾ç¤º

#### V1.2.0
**å‘å¸ƒæ—¥æœŸ:** 2025-10-28  
**ç±»å‹:** é‡å¤§åŠŸèƒ½æ›´æ–°

**ä¸»è¦æ›´æ–°:**
1. æ‰¹é‡å…³é”®è¯æœç´¢ - å¤šè¡Œè¾“å…¥æ”¯æŒ
2. è¯¦ç»†è¿›åº¦æ˜¾ç¤º - å®æ—¶è¿›åº¦æ¡

**ä¿®æ”¹æ–‡ä»¶:**
- `gui_app.py` - æ‰¹é‡å¤„ç†é€»è¾‘

---

## ğŸ“‚ ä»£ç ç»“æ„è¯´æ˜

### é¡¹ç›®ç›®å½•ç»“æ„

```
MediaCrawler/
â”œâ”€â”€ config/                      # é…ç½®æ–‡ä»¶ç›®å½•
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ base_config.py          # åŸºç¡€é…ç½®
â”‚   â”œâ”€â”€ douyin_config.py        # æŠ–éŸ³é…ç½®
â”‚   â”œâ”€â”€ xhs_config.py           # å°çº¢ä¹¦é…ç½®
â”‚   â”œâ”€â”€ bilibili_config.py      # Bç«™é…ç½®
â”‚   â””â”€â”€ zhihu_config.py         # çŸ¥ä¹é…ç½®
â”‚
â”œâ”€â”€ media_platform/             # å¹³å°çˆ¬è™«ç›®å½•
â”‚   â”œâ”€â”€ douyin/                 # æŠ–éŸ³çˆ¬è™«
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ core.py            # æ ¸å¿ƒçˆ¬è™«é€»è¾‘
â”‚   â”‚   â”œâ”€â”€ client.py          # APIå®¢æˆ·ç«¯
â”‚   â”‚   â”œâ”€â”€ field.py           # å­—æ®µå®šä¹‰
â”‚   â”‚   â””â”€â”€ help.py            # è¾…åŠ©å‡½æ•°
â”‚   â”œâ”€â”€ xhs/                    # å°çº¢ä¹¦çˆ¬è™«
â”‚   â”œâ”€â”€ bilibili/               # Bç«™çˆ¬è™«
â”‚   â””â”€â”€ zhihu/                  # çŸ¥ä¹çˆ¬è™«
â”‚
â”œâ”€â”€ store/                      # æ•°æ®å­˜å‚¨ç›®å½•
â”‚   â”œâ”€â”€ douyin/
â”‚   â”‚   â””â”€â”€ _store_impl.py     # æŠ–éŸ³å­˜å‚¨å®ç°
â”‚   â”œâ”€â”€ xhs/
â”‚   â”œâ”€â”€ bilibili/
â”‚   â””â”€â”€ zhihu/
â”‚
â”œâ”€â”€ tools/                      # å·¥å…·æ¨¡å—ç›®å½•
â”‚   â”œâ”€â”€ async_file_writer.py   # å¼‚æ­¥æ–‡ä»¶å†™å…¥å™¨ â­ æ ¸å¿ƒ
â”‚   â”œâ”€â”€ utils.py               # é€šç”¨å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ time_util.py           # æ—¶é—´å·¥å…·
â”‚   â””â”€â”€ words.py               # è¯äº‘ç”Ÿæˆ
â”‚
â”œâ”€â”€ browser_manager.py          # æµè§ˆå™¨ç®¡ç†å™¨ â­ æ ¸å¿ƒ
â”œâ”€â”€ gui_app.py                  # GUIä¸»ç¨‹åº â­ æ ¸å¿ƒ
â”œâ”€â”€ start_gui.py                # GUIå¯åŠ¨å™¨
â”œâ”€â”€ main.py                     # å‘½ä»¤è¡Œå…¥å£
â”‚
â”œâ”€â”€ login_data/                 # ç™»å½•æ•°æ®ç›®å½•
â”‚   â”œâ”€â”€ dy_login_info/         # æŠ–éŸ³ç™»å½•ä¿¡æ¯
â”‚   â”œâ”€â”€ xhs_login_info/        # å°çº¢ä¹¦ç™»å½•ä¿¡æ¯
â”‚   â”œâ”€â”€ bili_login_info/       # Bç«™ç™»å½•ä¿¡æ¯
â”‚   â””â”€â”€ zhihu_login_info/      # çŸ¥ä¹ç™»å½•ä¿¡æ¯
â”‚
â”œâ”€â”€ browser_data/               # æµè§ˆå™¨æ•°æ®ç›®å½•
â”‚   â”œâ”€â”€ clean_dy_browser/      # æŠ–éŸ³æµè§ˆå™¨æ•°æ®
â”‚   â”œâ”€â”€ clean_xhs_browser/     # å°çº¢ä¹¦æµè§ˆå™¨æ•°æ®
â”‚   â””â”€â”€ ...
â”‚
â”œâ”€â”€ data/                       # æ•°æ®è¾“å‡ºç›®å½•
â”‚   â”œâ”€â”€ douyin/
â”‚   â”‚   â””â”€â”€ csv/               # CSVæ–‡ä»¶
â”‚   â”œâ”€â”€ xhs/
â”‚   â”œâ”€â”€ bilibili/
â”‚   â””â”€â”€ zhihu/
â”‚
â”œâ”€â”€ logs/                       # æ—¥å¿—ç›®å½•
â”‚   â””â”€â”€ gui_YYYYMMDD_HHMMSS.log
â”‚
â”œâ”€â”€ create_icon.py              # å›¾æ ‡ç”Ÿæˆè„šæœ¬
â”œâ”€â”€ icon.ico                    # è½¯ä»¶å›¾æ ‡
â”œâ”€â”€ icon_preview.png            # å›¾æ ‡é¢„è§ˆ
â”‚
â”œâ”€â”€ V1.2.4æ›´æ–°è¯´æ˜.md           # ç‰ˆæœ¬æ›´æ–°è¯´æ˜
â”œâ”€â”€ é¡¹ç›®äº¤æ¥æ–‡æ¡£.md             # æœ¬æ–‡æ¡£
â”œâ”€â”€ README.md                   # é¡¹ç›®è¯´æ˜
â””â”€â”€ requirements.txt            # ä¾èµ–åˆ—è¡¨
```

### æ ¸å¿ƒæ–‡ä»¶è¯´æ˜

#### 1. `gui_app.py` - GUIä¸»ç¨‹åº â­â­â­
**ä½œç”¨:** GUIç•Œé¢çš„æ ¸å¿ƒå®ç°  
**å…³é”®ç±»:** `MediaCrawlerGUI`  
**ä¸»è¦åŠŸèƒ½:**
- ç•Œé¢å¸ƒå±€å’Œç»„ä»¶åˆ›å»º
- ç”¨æˆ·äº¤äº’å¤„ç†
- å‚æ•°é…ç½®ç®¡ç†
- è¿›åº¦æ˜¾ç¤ºæ›´æ–°
- æµè§ˆå™¨ç®¡ç†è°ƒç”¨

**å…³é”®æ–¹æ³•:**
```python
class MediaCrawlerGUI:
    def __init__(self):
        # åˆå§‹åŒ–GUI
        
    def create_platform_selection(self):
        # åˆ›å»ºå¹³å°é€‰æ‹©ç•Œé¢
        
    def create_crawler_type_selection(self):
        # åˆ›å»ºé‡‡é›†æ¨¡å¼é€‰æ‹©
        
    def start_crawling(self):
        # å¼€å§‹é‡‡é›†(ä¸»è¦é€»è¾‘)
        
    def stop_crawling(self):
        # åœæ­¢é‡‡é›†
        
    def update_progress(self, current, total, video_title):
        # æ›´æ–°è¿›åº¦æ˜¾ç¤º
```

**ä¿®æ”¹å†å²:**
- V1.2.4: ç²¾ç®€å¹³å°åˆ—è¡¨,æ·»åŠ å›¾æ ‡è®¾ç½®
- V1.2.3: æ·»åŠ è¿›åº¦å›è°ƒæ˜¾ç¤º
- V1.2.2: æ·»åŠ æ¸…ç©ºè¾“å…¥æ¡†é€»è¾‘
- V1.2.1: æ·»åŠ è¿›åº¦æ˜¾ç¤ºç»„ä»¶

#### 2. `browser_manager.py` - æµè§ˆå™¨ç®¡ç†å™¨ â­â­â­
**ä½œç”¨:** ç»Ÿä¸€ç®¡ç†æµè§ˆå™¨å®ä¾‹å’Œç™»å½•çŠ¶æ€  
**å…³é”®ç±»:** `BrowserManager`  
**ä¸»è¦åŠŸèƒ½:**
- æµè§ˆå™¨å®ä¾‹åˆ›å»ºå’Œé”€æ¯
- ç™»å½•çŠ¶æ€ç®¡ç†
- Cookieä¿å­˜å’ŒåŠ è½½
- ç™»å½•æœ‰æ•ˆæ€§æ£€æµ‹

**å…³é”®æ–¹æ³•:**
```python
class BrowserManager:
    async def get_or_create_browser(self, platform):
        # è·å–æˆ–åˆ›å»ºæµè§ˆå™¨å®ä¾‹
        
    async def login(self, platform):
        # ç™»å½•æŒ‡å®šå¹³å°
        
    async def save_login_state(self, platform):
        # ä¿å­˜ç™»å½•çŠ¶æ€
        
    async def load_login_state(self, platform):
        # åŠ è½½ç™»å½•çŠ¶æ€
        
    def check_login_status(self, platform):
        # æ£€æŸ¥ç™»å½•çŠ¶æ€
```

**ä¿®æ”¹å†å²:**
- V1.2.3: ä¼˜åŒ–ç™»å½•çŠ¶æ€æ£€æµ‹
- V1.2.0: æ·»åŠ ç»Ÿä¸€æµè§ˆå™¨ç®¡ç†

#### 3. `tools/async_file_writer.py` - å¼‚æ­¥æ–‡ä»¶å†™å…¥å™¨ â­â­â­
**ä½œç”¨:** ç®¡ç†æ•°æ®æ–‡ä»¶çš„å†™å…¥å’Œå‘½å  
**å…³é”®ç±»:** `AsyncFileWriter`  
**ä¸»è¦åŠŸèƒ½:**
- æ–‡ä»¶è·¯å¾„ç”Ÿæˆ
- æ–‡ä»¶å‘½åè§„åˆ™
- CSV/JSONå†™å…¥
- åˆ—é¡ºåºç®¡ç†

**å…³é”®æ–¹æ³•:**
```python
class AsyncFileWriter:
    def _get_file_path(self, file_type, item_type):
        # ç”Ÿæˆæ–‡ä»¶è·¯å¾„(æ ¸å¿ƒå‘½åé€»è¾‘)
        
    async def write_to_csv(self, item, item_type):
        # å†™å…¥CSVæ–‡ä»¶
        
    async def write_single_item_to_json(self, item, item_type):
        # å†™å…¥JSONæ–‡ä»¶
```

**ä¿®æ”¹å†å²:**
- V1.2.4: ä¼˜åŒ–æ–‡ä»¶å‘½åè§„åˆ™(å…³é”®è¯_æ—¶é—´æˆ³_ç±»å‹)
- V1.2.2: æ·»åŠ æ—¶é—´æˆ³åˆ°æ–‡ä»¶å
- V1.2.1: æ–°å‘½åè§„åˆ™(å¹³å°_å…³é”®è¯_ç±»å‹)

---

## ğŸ”§ å…³é”®åŠŸèƒ½å®ç°

### 1. æ‰¹é‡å…³é”®è¯æœç´¢

**å®ç°ä½ç½®:** `gui_app.py` - `start_crawling()` æ–¹æ³•

**æ ¸å¿ƒé€»è¾‘:**
```python
async def start_crawling(self):
    # 1. è·å–å…³é”®è¯åˆ—è¡¨
    keywords_text = self.keywords_input.get("1.0", "end-1c")
    keywords_list = [kw.strip() for kw in keywords_text.split('\n') if kw.strip()]
    
    # 2. ä¾æ¬¡å¤„ç†æ¯ä¸ªå…³é”®è¯
    for index, keyword in enumerate(keywords_list, 1):
        # æ›´æ–°çŠ¶æ€
        self.update_status(f"[{index}/{total}] æ­£åœ¨é‡‡é›†: {keyword}")
        
        # è®¾ç½®é…ç½®
        config.KEYWORDS = keyword
        
        # æ‰§è¡Œé‡‡é›†
        await crawler.start()
        
        # æ›´æ–°è¿›åº¦
        self.update_progress(index, total, keyword)
```

**å…³é”®ç‚¹:**
- å¤šè¡Œè¾“å…¥,æ¯è¡Œä¸€ä¸ªå…³é”®è¯
- ä¾æ¬¡å¤„ç†,ä¸å¹¶å‘(é¿å…è¢«å¹³å°é™åˆ¶)
- æ¯ä¸ªå…³é”®è¯ç‹¬ç«‹æ–‡ä»¶
- å®æ—¶è¿›åº¦æ˜¾ç¤º

### 2. ç™»å½•çŠ¶æ€ç®¡ç†

**å®ç°ä½ç½®:** `browser_manager.py`

**æ ¸å¿ƒé€»è¾‘:**
```python
def check_login_status(self, platform):
    # 1. æ£€æŸ¥ç™»å½•æ–‡ä»¶æ˜¯å¦å­˜åœ¨
    login_dir = f"login_data/{platform}_login_info"
    info_file = f"{login_dir}/login_info.json"
    cookies_file = f"{login_dir}/cookies.json"
    
    if not os.path.exists(info_file):
        return False, "æœªæ‰¾åˆ°ç™»å½•æ–‡ä»¶"
    
    # 2. è¯»å–ç™»å½•æ—¶é—´
    with open(info_file, 'r') as f:
        info = json.load(f)
        login_time = info.get('login_time')
    
    # 3. æ£€æŸ¥æ˜¯å¦è¿‡æœŸ
    days_diff = (datetime.now() - datetime.fromisoformat(login_time)).days
    if days_diff > 30:
        return False, "ç™»å½•å·²è¿‡æœŸ"
    
    return True, "ç™»å½•æœ‰æ•ˆ"
```

**å…³é”®ç‚¹:**
- ç™»å½•ä¿¡æ¯ä¿å­˜ä¸ºJSON
- Cookieä¿å­˜ä¸ºJSON
- 30å¤©æœ‰æ•ˆæœŸ
- å¯åŠ¨æ—¶è‡ªåŠ¨æ£€æµ‹

### 3. æ–‡ä»¶å‘½åè§„åˆ™

**å®ç°ä½ç½®:** `tools/async_file_writer.py` - `_get_file_path()` æ–¹æ³•

**æ ¸å¿ƒé€»è¾‘:**
```python
def _get_file_path(self, file_type, item_type):
    # 1. ç”Ÿæˆæ—¶é—´æˆ³
    timestamp = time.strftime("%Y%m%d_%H%M%S")
    
    # 2. ç±»å‹åç§°æ˜ å°„
    type_names = {
        "comments": "è¯„è®º",
        "contents": "å†…å®¹",
        "creators": "åˆ›ä½œè€…",
        "videos": "è§†é¢‘"
    }
    type_name = type_names.get(item_type, item_type)
    
    # 3. æ ¹æ®é‡‡é›†æ¨¡å¼å†³å®šæ–‡ä»¶å
    crawler_type = config.CRAWLER_TYPE
    
    if crawler_type == "search":
        # å…³é”®è¯æœç´¢: å…³é”®è¯_æ—¶é—´æˆ³_ç±»å‹.csv
        keywords = config.KEYWORDS
        clean_keywords = re.sub(r'[\\/:*?"<>|\s]+', '_', keywords.strip())
        file_name = f"{clean_keywords}_{timestamp}_{type_name}.{file_type}"
        
    elif crawler_type == "detail":
        # å¤šé“¾æ¥: æ—¶é—´æˆ³_Næ¡è§†é¢‘_ç±»å‹.csv
        video_count = len(config.DY_SPECIFIED_ID_LIST)
        file_name = f"{timestamp}_{video_count}æ¡è§†é¢‘_{type_name}.{file_type}"
        
    elif crawler_type == "creator":
        # åˆ›ä½œè€…: åšä¸»æ˜µç§°_Mæ¡è§†é¢‘_ç±»å‹.csv
        nickname = self.creator_info.get("nickname", "æœªå‘½å")
        video_count = self.creator_info.get("video_count", 0)
        clean_nickname = re.sub(r'[\\/:*?"<>|\s]+', '_', nickname)
        file_name = f"{clean_nickname}_{video_count}æ¡è§†é¢‘_{type_name}.{file_type}"
    
    return f"{base_path}/{file_name}"
```

**å…³é”®ç‚¹:**
- æ—¶é—´æˆ³æ ¼å¼: YYYYMMDD_HHMMSS
- ç‰¹æ®Šå­—ç¬¦æ›¿æ¢ä¸ºä¸‹åˆ’çº¿
- ä¸åŒæ¨¡å¼ä¸åŒå‘½åè§„åˆ™
- åŒ…å«ç±»å‹åç¼€(è¯„è®º/å†…å®¹)

### 4. è¿›åº¦æ˜¾ç¤º

**å®ç°ä½ç½®:** `gui_app.py` - `update_progress()` æ–¹æ³•

**æ ¸å¿ƒé€»è¾‘:**
```python
def update_progress(self, current, total, video_title):
    # 1. æ›´æ–°è¿›åº¦æ¡
    progress = (current / total) * 100
    self.progress_bar.set(progress / 100)
    
    # 2. æ›´æ–°è¿›åº¦æ–‡æœ¬
    self.progress_label.configure(
        text=f"[{self.current_keyword_index}/{self.total_keywords}] {current}/{total} è§†é¢‘"
    )
    
    # 3. æ›´æ–°çŠ¶æ€æ 
    self.update_status(f"ğŸ”¥ æ­£åœ¨é‡‡é›†ç¬¬{current}ä¸ªè§†é¢‘: {video_title}")
```

**å…³é”®ç‚¹:**
- åŒå±‚è¿›åº¦(å…³é”®è¯è¿›åº¦ + è§†é¢‘è¿›åº¦)
- å®æ—¶æ˜¾ç¤ºè§†é¢‘æ ‡é¢˜
- ç™¾åˆ†æ¯”è¿›åº¦æ¡
- å‹å¥½çš„çŠ¶æ€æç¤º

---

## ğŸ§ª æµ‹è¯•ä¸éªŒè¯

### æµ‹è¯•ç¯å¢ƒ
- **æ“ä½œç³»ç»Ÿ:** Windows 11
- **Pythonç‰ˆæœ¬:** 3.12.8
- **æµè§ˆå™¨:** Chromium (Playwright)

### åŠŸèƒ½æµ‹è¯•æ¸…å•

#### 1. ç™»å½•åŠŸèƒ½æµ‹è¯•
- [x] æŠ–éŸ³æ‰«ç ç™»å½•
- [x] å°çº¢ä¹¦æ‰«ç ç™»å½•
- [x] Bç«™æ‰«ç ç™»å½•
- [x] çŸ¥ä¹æ‰«ç ç™»å½•
- [x] ç™»å½•çŠ¶æ€ä¿å­˜
- [x] ç™»å½•çŠ¶æ€æ¢å¤
- [x] ç™»å½•æœ‰æ•ˆæ€§æ£€æµ‹

#### 2. é‡‡é›†åŠŸèƒ½æµ‹è¯•
- [x] å…³é”®è¯æœç´¢é‡‡é›†
- [x] æ‰¹é‡å…³é”®è¯é‡‡é›†
- [x] æŒ‡å®šè§†é¢‘é“¾æ¥é‡‡é›†
- [x] åˆ›ä½œè€…ä¸»é¡µé‡‡é›†
- [x] è¯„è®ºæ•°æ®å®Œæ•´æ€§
- [x] æ–‡ä»¶å‘½åæ­£ç¡®æ€§

#### 3. ç”¨æˆ·ä½“éªŒæµ‹è¯•
- [x] è¿›åº¦æ˜¾ç¤ºå‡†ç¡®æ€§
- [x] åœæ­¢åŠŸèƒ½æœ‰æ•ˆæ€§
- [x] é”™è¯¯æç¤ºå‹å¥½æ€§
- [x] å›¾æ ‡æ˜¾ç¤ºæ­£ç¡®æ€§

### å·²çŸ¥é€šè¿‡çš„æµ‹è¯•ç”¨ä¾‹

#### æµ‹è¯•ç”¨ä¾‹1: å•å…³é”®è¯æœç´¢
**è¾“å…¥:**
- å¹³å°: æŠ–éŸ³
- æ¨¡å¼: å…³é”®è¯æœç´¢
- å…³é”®è¯: "ç¾é£Ÿæ¢åº—"
- è§†é¢‘æ•°é‡: 10

**é¢„æœŸè¾“å‡º:**
- æ–‡ä»¶: `ç¾é£Ÿæ¢åº—_20251103_HHMMSS_è¯„è®º.csv`
- æ•°æ®: 10ä¸ªè§†é¢‘çš„è¯„è®ºæ•°æ®

**ç»“æœ:** âœ… é€šè¿‡

#### æµ‹è¯•ç”¨ä¾‹2: æ‰¹é‡å…³é”®è¯æœç´¢
**è¾“å…¥:**
- å¹³å°: æŠ–éŸ³
- æ¨¡å¼: å…³é”®è¯æœç´¢
- å…³é”®è¯: 
  ```
  ç¾é£Ÿæ¢åº—
  æ—…æ¸¸æ”»ç•¥
  ç§‘æŠ€æ•°ç 
  ```
- è§†é¢‘æ•°é‡: 10

**é¢„æœŸè¾“å‡º:**
- æ–‡ä»¶1: `ç¾é£Ÿæ¢åº—_20251103_HHMMSS_è¯„è®º.csv`
- æ–‡ä»¶2: `æ—…æ¸¸æ”»ç•¥_20251103_HHMMSS_è¯„è®º.csv`
- æ–‡ä»¶3: `ç§‘æŠ€æ•°ç _20251103_HHMMSS_è¯„è®º.csv`

**ç»“æœ:** âœ… é€šè¿‡

#### æµ‹è¯•ç”¨ä¾‹3: ç™»å½•çŠ¶æ€æ¢å¤
**æ“ä½œ:**
1. é¦–æ¬¡ç™»å½•æŠ–éŸ³
2. å…³é—­GUI
3. é‡æ–°å¯åŠ¨GUI

**é¢„æœŸç»“æœ:**
- è‡ªåŠ¨æ£€æµ‹åˆ°ç™»å½•çŠ¶æ€
- æ˜¾ç¤º"âœ… ç™»å½•æœ‰æ•ˆ"
- æ— éœ€é‡æ–°ç™»å½•

**ç»“æœ:** âœ… é€šè¿‡

---

## âš ï¸ å·²çŸ¥é—®é¢˜ä¸é™åˆ¶

### å·²çŸ¥é—®é¢˜

#### 1. å¹³å°é™åˆ¶é£é™©
**é—®é¢˜:** çŸ­æ—¶é—´å¤§é‡é‡‡é›†å¯èƒ½è¢«å¹³å°é™åˆ¶  
**å½±å“:** é‡‡é›†å¤±è´¥æˆ–è´¦å·è¢«é™åˆ¶  
**å»ºè®®:** 
- æ§åˆ¶é‡‡é›†é¢‘ç‡
- é¿å…è¿ç»­å¤§é‡é‡‡é›†
- ä½¿ç”¨å¤šä¸ªè´¦å·è½®æ¢

#### 2. ç™»å½•è¿‡æœŸé—®é¢˜
**é—®é¢˜:** 30å¤©åç™»å½•ä¿¡æ¯è¿‡æœŸ  
**å½±å“:** éœ€è¦é‡æ–°ç™»å½•  
**å»ºè®®:**
- å®šæœŸæ£€æŸ¥ç™»å½•çŠ¶æ€
- è¿‡æœŸå‰é‡æ–°ç™»å½•

#### 3. æµè§ˆå™¨èµ„æºå ç”¨
**é—®é¢˜:** é•¿æ—¶é—´è¿è¡Œæµè§ˆå™¨å ç”¨å†…å­˜  
**å½±å“:** ç³»ç»Ÿå˜æ…¢  
**å»ºè®®:**
- é‡‡é›†å®Œæˆåå…³é—­GUI
- å®šæœŸé‡å¯è½¯ä»¶

### åŠŸèƒ½é™åˆ¶

#### 1. åªæ”¯æŒ4ä¸ªå¹³å°
**é™åˆ¶:** å¿«æ‰‹ã€å¾®åšã€è´´å§å·²ç§»é™¤  
**åŸå› :** ç”¨æˆ·åªéœ€è¦è¿™4ä¸ªå¹³å°  
**å½±å“:** æ— æ³•é‡‡é›†å…¶ä»–å¹³å°æ•°æ®

#### 2. åªé‡‡é›†è¯„è®º
**é™åˆ¶:** ä¸é‡‡é›†è§†é¢‘å†…å®¹å’Œåˆ›ä½œè€…ä¿¡æ¯  
**åŸå› :** ç”¨æˆ·åªéœ€è¦è¯„è®ºæ•°æ®  
**å½±å“:** æ— æ³•è·å–å®Œæ•´æ•°æ®

#### 3. ä¾èµ–æµè§ˆå™¨ç™»å½•
**é™åˆ¶:** å¿…é¡»é€šè¿‡æµè§ˆå™¨æ‰«ç ç™»å½•  
**åŸå› :** å¹³å°å®‰å…¨é™åˆ¶  
**å½±å“:** æ— æ³•å®Œå…¨è‡ªåŠ¨åŒ–

---

## ğŸš€ åç»­å¼€å‘å»ºè®®

### çŸ­æœŸä¼˜åŒ– (1-2å‘¨)

#### 1. æ€§èƒ½ä¼˜åŒ–
- [ ] ä¼˜åŒ–å†…å­˜ä½¿ç”¨
- [ ] å‡å°‘æµè§ˆå™¨èµ„æºå ç”¨
- [ ] åŠ å¿«é‡‡é›†é€Ÿåº¦

#### 2. ç”¨æˆ·ä½“éªŒ
- [ ] æ·»åŠ é‡‡é›†å†å²è®°å½•
- [ ] æ”¯æŒæš‚åœ/ç»§ç»­åŠŸèƒ½
- [ ] æ·»åŠ æ•°æ®é¢„è§ˆåŠŸèƒ½

#### 3. é”™è¯¯å¤„ç†
- [ ] æ›´è¯¦ç»†çš„é”™è¯¯æç¤º
- [ ] è‡ªåŠ¨é‡è¯•æœºåˆ¶
- [ ] å¼‚å¸¸æ¢å¤åŠŸèƒ½

### ä¸­æœŸè§„åˆ’ (1-2æœˆ)

#### 1. æ•°æ®åˆ†æ
- [ ] å†…ç½®æ•°æ®ç»Ÿè®¡åŠŸèƒ½
- [ ] è¯äº‘å›¾ç”Ÿæˆ
- [ ] æƒ…æ„Ÿåˆ†æ

#### 2. å¯¼å‡ºæ ¼å¼
- [ ] æ”¯æŒExcelæ ¼å¼
- [ ] æ”¯æŒæ•°æ®åº“å­˜å‚¨
- [ ] è‡ªå®šä¹‰å¯¼å‡ºæ¨¡æ¿

#### 3. æ‰¹é‡ç®¡ç†
- [ ] ä»»åŠ¡é˜Ÿåˆ—ç®¡ç†
- [ ] å®šæ—¶é‡‡é›†åŠŸèƒ½
- [ ] å¤šè´¦å·ç®¡ç†

### é•¿æœŸæ„¿æ™¯ (3-6æœˆ)

#### 1. å¹³å°æ‰©å±•
- [ ] æ”¯æŒæ›´å¤šå¹³å°
- [ ] å›½é™…å¹³å°æ”¯æŒ
- [ ] è‡ªå®šä¹‰å¹³å°é€‚é…

#### 2. æ™ºèƒ½åŒ–
- [ ] AIè¾…åŠ©å…³é”®è¯æ¨è
- [ ] æ™ºèƒ½å»é‡
- [ ] è‡ªåŠ¨åˆ†ç±»

#### 3. å•†ä¸šåŒ–
- [ ] ä»˜è´¹ç‰ˆæœ¬
- [ ] APIæ¥å£
- [ ] äº‘ç«¯æœåŠ¡

---

## ğŸ“– å¿«é€Ÿä¸Šæ‰‹æŒ‡å—

### æ–°å¼€å‘è€…æ¥æ‰‹æ­¥éª¤

#### ç¬¬1æ­¥: ç¯å¢ƒå‡†å¤‡ (30-60åˆ†é’Ÿ)

**ç³»ç»Ÿè¦æ±‚:**
- **æ“ä½œç³»ç»Ÿ:** Windows 10/11 (æ¨è), macOS 10.15+, Linux (Ubuntu 20.04+)
- **Pythonç‰ˆæœ¬:** 3.8+ (å¼ºçƒˆæ¨è3.12.8,å·²æµ‹è¯•é€šè¿‡)
- **å†…å­˜:** æœ€ä½4GB,æ¨è8GB+
- **ç£ç›˜ç©ºé—´:** æœ€ä½2GB(åŒ…å«æµè§ˆå™¨é©±åŠ¨)
- **ç½‘ç»œ:** éœ€è¦è®¿é—®å¤–ç½‘(å®‰è£…ä¾èµ–å’Œæµè§ˆå™¨é©±åŠ¨)

**Pythonç‰ˆæœ¬å…¼å®¹æ€§:**
| Pythonç‰ˆæœ¬ | å…¼å®¹æ€§ | è¯´æ˜ |
|-----------|--------|------|
| 3.8 | âœ… å…¼å®¹ | æœ€ä½è¦æ±‚ç‰ˆæœ¬ |
| 3.9 | âœ… å…¼å®¹ | å®Œå…¨æ”¯æŒ |
| 3.10 | âœ… å…¼å®¹ | å®Œå…¨æ”¯æŒ |
| 3.11 | âœ… å…¼å®¹ | å®Œå…¨æ”¯æŒ |
| 3.12 | âœ… æ¨è | å½“å‰å¼€å‘ç‰ˆæœ¬ |
| 3.13+ | âš ï¸ æœªæµ‹è¯• | å¯èƒ½å…¼å®¹ |

**è¯¦ç»†å®‰è£…æ­¥éª¤:**

1. **å®‰è£…Python**

   **Windows:**
   ```bash
   # ä»python.orgä¸‹è½½å®‰è£…åŒ…
   # https://www.python.org/downloads/
   # âš ï¸ å®‰è£…æ—¶åŠ¡å¿…å‹¾é€‰"Add Python to PATH"

   # éªŒè¯å®‰è£…
   python --version
   # åº”è¯¥æ˜¾ç¤º: Python 3.12.8
   ```

   **macOS:**
   ```bash
   # ä½¿ç”¨Homebrewå®‰è£…
   brew install python@3.12

   # éªŒè¯å®‰è£…
   python3 --version
   ```

   **Linux:**
   ```bash
   # Ubuntu/Debian
   sudo apt update
   sudo apt install python3.12 python3.12-venv python3-pip

   # éªŒè¯å®‰è£…
   python3 --version
   ```

2. **å…‹éš†é¡¹ç›®**
   ```bash
   git clone https://github.com/InterestWatcher-Xiaofeng/-.git
   cd MediaCrawler/MediaCrawler
   ```

3. **åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ(æ¨è)**
   ```bash
   # Windows
   python -m venv venv
   venv\Scripts\activate

   # macOS/Linux
   python3 -m venv venv
   source venv/bin/activate
   ```

4. **å®‰è£…Pythonä¾èµ–**
   ```bash
   # å‡çº§pip
   python -m pip install --upgrade pip

   # å®‰è£…ä¾èµ–
   pip install -r requirements.txt

   # éªŒè¯å®‰è£…
   pip list
   ```

   **å¸¸è§é—®é¢˜:**
   - âŒ `pip install`å¤±è´¥: ä½¿ç”¨å›½å†…é•œåƒ
     ```bash
     pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple
     ```
   - âŒ ç½‘ç»œè¶…æ—¶: å¢åŠ è¶…æ—¶æ—¶é—´
     ```bash
     pip install -r requirements.txt --timeout 300
     ```

5. **å®‰è£…Playwrightæµè§ˆå™¨**
   ```bash
   # å®‰è£…Chromiumæµè§ˆå™¨
   playwright install chromium

   # å¦‚æœä¸‹è½½æ…¢,ä½¿ç”¨å›½å†…é•œåƒ
   # Windows PowerShell
   $env:PLAYWRIGHT_DOWNLOAD_HOST="https://npmmirror.com/mirrors/playwright/"
   playwright install chromium

   # macOS/Linux
   export PLAYWRIGHT_DOWNLOAD_HOST=https://npmmirror.com/mirrors/playwright/
   playwright install chromium
   ```

   **Playwrightæµè§ˆå™¨è¯´æ˜:**
   - ä¸‹è½½å¤§å°: çº¦300MB
   - å®‰è£…ä½ç½®:
     - Windows: `%USERPROFILE%\AppData\Local\ms-playwright`
     - macOS: `~/Library/Caches/ms-playwright`
     - Linux: `~/.cache/ms-playwright`
   - å¯ä»¥åˆ é™¤å—? ä¸å¯ä»¥,çˆ¬è™«ä¾èµ–æ­¤æµè§ˆå™¨

6. **éªŒè¯å®‰è£…**
   ```bash
   # å¯åŠ¨GUI
   python start_gui.py

   # åº”è¯¥çœ‹åˆ°:
   # âœ… Pythonç‰ˆæœ¬æ£€æŸ¥é€šè¿‡: 3.12.8
   # âœ… æ‰€æœ‰å¿…éœ€åŒ…å·²å®‰è£…
   # âœ… GUIæ–‡ä»¶æ£€æŸ¥é€šè¿‡
   # âœ… MediaCrawleræ ¸å¿ƒæ–‡ä»¶æ£€æŸ¥é€šè¿‡
   # ğŸš€ æ­£åœ¨å¯åŠ¨MediaCrawler GUI...
   ```

**ç¯å¢ƒæ­å»ºå¸¸è§é—®é¢˜:**

| é—®é¢˜ | åŸå›  | è§£å†³æ–¹æ³• |
|------|------|----------|
| `ModuleNotFoundError: No module named 'customtkinter'` | ä¾èµ–æœªå®‰è£… | `pip install customtkinter` |
| `playwright._impl._api_types.Error: Executable doesn't exist` | æµè§ˆå™¨æœªå®‰è£… | `playwright install chromium` |
| `ImportError: DLL load failed` (Windows) | ç¼ºå°‘VC++è¿è¡Œåº“ | å®‰è£…Visual C++ Redistributable |
| `Permission denied` (Linux) | æƒé™ä¸è¶³ | `sudo playwright install-deps chromium` |

---

#### ç¬¬2æ­¥: ç†è§£é…ç½®ç³»ç»Ÿ (30-60åˆ†é’Ÿ)

**é…ç½®æ–‡ä»¶ä½“ç³»:**

```
config/
â”œâ”€â”€ __init__.py           # é…ç½®å…¥å£
â”œâ”€â”€ base_config.py        # åŸºç¡€é…ç½®(æ ¸å¿ƒ)
â”œâ”€â”€ db_config.py          # æ•°æ®åº“é…ç½®
â”œâ”€â”€ dy_config.py          # æŠ–éŸ³å¹³å°é…ç½®
â”œâ”€â”€ xhs_config.py         # å°çº¢ä¹¦å¹³å°é…ç½®
â”œâ”€â”€ bilibili_config.py    # Bç«™å¹³å°é…ç½®
â””â”€â”€ zhihu_config.py       # çŸ¥ä¹å¹³å°é…ç½®
```

**â­â­â­ é…ç½®æ–‡ä»¶ vs GUIç•Œé¢çš„å…³ç³»(é‡è¦)**

```
é…ç½®ä¼˜å…ˆçº§è§„åˆ™:
GUIè®¾ç½® > config/base_config.py > å¹³å°é»˜è®¤å€¼

å·¥ä½œæµç¨‹:
1. ç¨‹åºå¯åŠ¨ â†’ è¯»å–config/base_config.py
2. GUIæ˜¾ç¤º â†’ æ˜¾ç¤ºé…ç½®æ–‡ä»¶çš„å€¼
3. ç”¨æˆ·ä¿®æ”¹GUI â†’ ä¸´æ—¶è¦†ç›–é…ç½®æ–‡ä»¶
4. ç‚¹å‡»"å¼€å§‹é‡‡é›†" â†’ è°ƒç”¨update_config()æ›´æ–°é…ç½®
5. çˆ¬è™«è¿è¡Œ â†’ ä½¿ç”¨æ›´æ–°åçš„é…ç½®
6. ç¨‹åºå…³é—­ â†’ é…ç½®æ–‡ä»¶ä¸ä¼šè¢«ä¿®æ”¹(é™¤éæ‰‹åŠ¨ä¿å­˜)
```

**å…³é”®ä»£ç (gui_app.py line 1814-1831):**
```python
def update_config(self):
    """æ›´æ–°MediaCrawleré…ç½®"""
    import config

    # GUIè®¾ç½®ä¸´æ—¶è¦†ç›–é…ç½®æ–‡ä»¶
    config.PLATFORM = self.platform_var.get()
    config.CRAWLER_TYPE = self.crawler_type_var.get()
    config.LOGIN_TYPE = self.login_type_var.get()
    config.SAVE_DATA_OPTION = self.save_format_var.get()

    # ç¡®ä¿ç™»å½•çŠ¶æ€ä¿å­˜å¼€å¯
    config.SAVE_LOGIN_STATE = True
```

**å®Œæ•´é…ç½®æ–‡ä»¶ç¤ºä¾‹(config/base_config.py):**

```python
# ==================== å¹³å°é…ç½® ====================
PLATFORM = "xhs"  # å¹³å°: xhs(å°çº¢ä¹¦) | dy(æŠ–éŸ³) | bili(Bç«™) | zhihu(çŸ¥ä¹)
KEYWORDS = "ç©å…·"  # æœç´¢å…³é”®è¯
LOGIN_TYPE = "qrcode"  # ç™»å½•æ–¹å¼: qrcode(æ‰«ç ) | phone(æ‰‹æœºå·) | cookie
CRAWLER_TYPE = "search"  # é‡‡é›†æ¨¡å¼: search(å…³é”®è¯) | detail(é“¾æ¥) | creator(åˆ›ä½œè€…)

# ==================== æµè§ˆå™¨é…ç½® ====================
HEADLESS = False  # æ— å¤´æ¨¡å¼: True(ä¸æ˜¾ç¤ºæµè§ˆå™¨) | False(æ˜¾ç¤ºæµè§ˆå™¨)
SAVE_LOGIN_STATE = True  # æ˜¯å¦ä¿å­˜ç™»å½•çŠ¶æ€

# ==================== CDPæ¨¡å¼é…ç½® â­â­â­ é‡è¦ ====================
ENABLE_CDP_MODE = True  # æ˜¯å¦å¯ç”¨CDPæ¨¡å¼(æ¨èTrue)
CDP_DEBUG_PORT = 9222  # CDPè°ƒè¯•ç«¯å£
CUSTOM_BROWSER_PATH = ""  # è‡ªå®šä¹‰æµè§ˆå™¨è·¯å¾„(ç•™ç©ºè‡ªåŠ¨æ£€æµ‹)
CDP_HEADLESS = False  # CDPæ¨¡å¼ä¸‹çš„æ— å¤´æ¨¡å¼
BROWSER_LAUNCH_TIMEOUT = 30  # æµè§ˆå™¨å¯åŠ¨è¶…æ—¶(ç§’)
AUTO_CLOSE_BROWSER = True  # ç¨‹åºç»“æŸæ—¶æ˜¯å¦å…³é—­æµè§ˆå™¨

# ==================== æ•°æ®ä¿å­˜é…ç½® ====================
SAVE_DATA_OPTION = "json"  # ä¿å­˜æ ¼å¼: csv | db | json | sqlite
USER_DATA_DIR = "%s_user_data_dir"  # æµè§ˆå™¨æ•°æ®ç›®å½•

# ==================== é‡‡é›†æ§åˆ¶é…ç½® ====================
CRAWLER_MAX_NOTES_COUNT = 3  # æ¯ä¸ªå…³é”®è¯é‡‡é›†çš„è§†é¢‘/ç¬”è®°æ•°é‡
MAX_CONCURRENCY_NUM = 1  # å¹¶å‘æ•°(å»ºè®®1)
ENABLE_GET_COMMENTS = True  # æ˜¯å¦é‡‡é›†è¯„è®º
CRAWLER_MAX_COMMENTS_COUNT_SINGLENOTES = 50  # æ¯ä¸ªè§†é¢‘é‡‡é›†çš„è¯„è®ºæ•°
ENABLE_GET_SUB_COMMENTS = False  # æ˜¯å¦é‡‡é›†äºŒçº§è¯„è®º
```

**â­â­â­ CDPæ¨¡å¼è¯¦è§£(æ ¸å¿ƒæ¦‚å¿µ)**

**ä»€ä¹ˆæ˜¯CDPæ¨¡å¼?**
- CDP = Chrome DevTools Protocol
- ä½¿ç”¨ç”¨æˆ·æœ¬åœ°çš„Chrome/Edgeæµè§ˆå™¨,è€Œä¸æ˜¯Playwrightçš„Chromium

**ä¸ºä»€ä¹ˆä½¿ç”¨CDPæ¨¡å¼?**
```
æ ‡å‡†æ¨¡å¼(Playwright Chromium):
âŒ ä½¿ç”¨Playwrightè‡ªå¸¦çš„Chromium
âŒ å®¹æ˜“è¢«æ£€æµ‹ä¸ºè‡ªåŠ¨åŒ–
âŒ æ— æ³•ä½¿ç”¨æµè§ˆå™¨æ‰©å±•

CDPæ¨¡å¼(ç”¨æˆ·çš„Chrome/Edge):
âœ… ä½¿ç”¨çœŸå®æµè§ˆå™¨ç¯å¢ƒ
âœ… åæ£€æµ‹èƒ½åŠ›å¼º
âœ… å¯ä»¥ä½¿ç”¨æµè§ˆå™¨æ‰©å±•
âœ… å¯ä»¥ä½¿ç”¨å·²æœ‰çš„Cookie
```

**CDPæ¨¡å¼å·¥ä½œåŸç†:**
```
1. æ£€æµ‹æµè§ˆå™¨è·¯å¾„
   Windows: C:\Program Files\Google\Chrome\Application\chrome.exe
   macOS: /Applications/Google Chrome.app/Contents/MacOS/Google Chrome

2. å¯åŠ¨æµè§ˆå™¨(å¸¦CDPå‚æ•°)
   chrome.exe --remote-debugging-port=9222

3. é€šè¿‡CDPè¿æ¥
   playwright.chromium.connect_over_cdp("http://localhost:9222")

4. æ§åˆ¶æµè§ˆå™¨
```

**CDPæ¨¡å¼å¸¸è§é—®é¢˜:**

| é—®é¢˜ | åŸå›  | è§£å†³æ–¹æ³• |
|------|------|----------|
| `CDPè¿æ¥å¤±è´¥` | Chromeæ­£åœ¨è¿è¡Œ | å…³é—­æ‰€æœ‰Chromeçª—å£åé‡è¯• |
| `ç«¯å£è¢«å ç”¨` | 9222ç«¯å£è¢«å ç”¨ | ç¨‹åºä¼šè‡ªåŠ¨å°è¯•9223,9224... |
| `æµè§ˆå™¨è·¯å¾„æ£€æµ‹å¤±è´¥` | éæ ‡å‡†å®‰è£…è·¯å¾„ | æ‰‹åŠ¨è®¾ç½®`CUSTOM_BROWSER_PATH` |

---

#### ç¬¬3æ­¥: ç†Ÿæ‚‰ä»£ç  (2å°æ—¶)

1. **é˜…è¯»æ ¸å¿ƒæ–‡ä»¶**
   - `gui_app.py` - GUIä¸»ç¨‹åº
   - `browser_manager.py` - æµè§ˆå™¨ç®¡ç†
   - `tools/async_file_writer.py` - æ–‡ä»¶å†™å…¥

2. **ç†è§£æ•°æ®æµ**
   ```
   ç”¨æˆ·è¾“å…¥ â†’ GUIé…ç½® â†’ æµè§ˆå™¨é‡‡é›† â†’ æ•°æ®å­˜å‚¨ â†’ æ–‡ä»¶è¾“å‡º
   ```

3. **æŸ¥çœ‹é…ç½®æ–‡ä»¶**
   - `config/base_config.py` - åŸºç¡€é…ç½®
   - `config/douyin_config.py` - æŠ–éŸ³é…ç½®

#### ç¬¬3æ­¥: æµ‹è¯•åŠŸèƒ½ (1å°æ—¶)

1. **ç™»å½•æµ‹è¯•**
   - å¯åŠ¨GUI
   - é€‰æ‹©æŠ–éŸ³å¹³å°
   - ç‚¹å‡»"ç™»å½•æŠ–éŸ³"
   - æ‰«ç ç™»å½•

2. **é‡‡é›†æµ‹è¯•**
   - è¾“å…¥å…³é”®è¯"æµ‹è¯•"
   - è®¾ç½®è§†é¢‘æ•°é‡ä¸º2
   - ç‚¹å‡»"å¼€å§‹é‡‡é›†"
   - æŸ¥çœ‹è¾“å‡ºæ–‡ä»¶

3. **éªŒè¯æ•°æ®**
   - æ‰“å¼€ç”Ÿæˆçš„CSVæ–‡ä»¶
   - æ£€æŸ¥æ•°æ®å®Œæ•´æ€§
   - éªŒè¯æ–‡ä»¶å‘½å

#### ç¬¬4æ­¥: å¼€å§‹å¼€å‘ (æ ¹æ®éœ€æ±‚)

1. **åˆ›å»ºæ–°åˆ†æ”¯**
```bash
git checkout -b feature/your-feature-name
```

2. **ä¿®æ”¹ä»£ç **
   - æ ¹æ®éœ€æ±‚ä¿®æ”¹ç›¸åº”æ–‡ä»¶
   - éµå¾ªç°æœ‰ä»£ç é£æ ¼
   - æ·»åŠ å¿…è¦æ³¨é‡Š

3. **æµ‹è¯•éªŒè¯**
   - æµ‹è¯•æ–°åŠŸèƒ½
   - ç¡®ä¿ä¸å½±å“ç°æœ‰åŠŸèƒ½
   - æ›´æ–°æ–‡æ¡£

4. **æäº¤ä»£ç **
```bash
git add .
git commit -m "æè¿°ä½ çš„ä¿®æ”¹"
git push origin feature/your-feature-name
```

### å¸¸è§å¼€å‘ä»»åŠ¡

#### ä»»åŠ¡1: æ·»åŠ æ–°å¹³å°æ”¯æŒ

**æ­¥éª¤:**
1. åœ¨ `gui_app.py` çš„ `self.platforms` ä¸­æ·»åŠ å¹³å°ä¿¡æ¯
2. åœ¨ `media_platform/` ä¸‹åˆ›å»ºå¹³å°ç›®å½•
3. å®ç°å¹³å°çˆ¬è™«é€»è¾‘
4. åœ¨ `store/` ä¸‹åˆ›å»ºå­˜å‚¨å®ç°
5. æµ‹è¯•éªŒè¯

#### ä»»åŠ¡2: ä¿®æ”¹æ–‡ä»¶å‘½åè§„åˆ™

**æ­¥éª¤:**
1. æ‰“å¼€ `tools/async_file_writer.py`
2. æ‰¾åˆ° `_get_file_path()` æ–¹æ³•
3. ä¿®æ”¹æ–‡ä»¶åç”Ÿæˆé€»è¾‘
4. æµ‹è¯•éªŒè¯

#### ä»»åŠ¡3: æ·»åŠ æ–°çš„é‡‡é›†æ¨¡å¼

**æ­¥éª¤:**
1. åœ¨ `gui_app.py` çš„ `create_crawler_type_selection()` ä¸­æ·»åŠ é€‰é¡¹
2. åœ¨ `config/base_config.py` ä¸­æ·»åŠ é…ç½®å‚æ•°
3. åœ¨å¹³å°çˆ¬è™«ä¸­å®ç°æ–°æ¨¡å¼é€»è¾‘
4. æµ‹è¯•éªŒè¯

---

## ğŸ“ è”ç³»æ–¹å¼

### é¡¹ç›®è´Ÿè´£äºº
- **å§“å:** yufeng
- **GitHub:** InterestWatcher-Xiaofeng
- **é‚®ç®±:** 158789466+InterestWatcher-Xiaofeng@users.noreply.github.com

### é¡¹ç›®èµ„æº
- **GitHubä»“åº“:** https://github.com/InterestWatcher-Xiaofeng/-
- **åŸå§‹é¡¹ç›®:** https://github.com/NanmiCoder/MediaCrawler
- **é—®é¢˜åé¦ˆ:** GitHub Issues

---

## ğŸ“„ é™„å½•

### A. ä¾èµ–åˆ—è¡¨

```
customtkinter>=5.2.0
pillow>=10.0.0
playwright>=1.40.0
httpx>=0.25.0
aiofiles>=23.2.1
jieba>=0.42.1
```

### B. é…ç½®æ–‡ä»¶æ¨¡æ¿

```python
# config/base_config.py æ ¸å¿ƒé…ç½®

# é‡‡é›†æ¨¡å¼
CRAWLER_TYPE = "search"  # search / detail / creator

# å…³é”®è¯
KEYWORDS = "ç¾é£Ÿæ¢åº—"

# é‡‡é›†æ•°é‡
CRAWLER_MAX_NOTES_COUNT = 10
MAX_COMMENTS_PER_POST = 100

# ä¿å­˜æ ¼å¼
SAVE_DATA_OPTION = "csv"  # csv / json / db

# æµè§ˆå™¨è®¾ç½®
HEADLESS = False
BROWSER_TYPE = "chromium"
```

### C. Gitæäº¤è§„èŒƒ

```
æ ¼å¼: <ç±»å‹>: <ç®€çŸ­æè¿°>

ç±»å‹:
- feat: æ–°åŠŸèƒ½
- fix: Bugä¿®å¤
- docs: æ–‡æ¡£æ›´æ–°
- style: ä»£ç æ ¼å¼
- refactor: é‡æ„
- test: æµ‹è¯•
- chore: æ„å»º/å·¥å…·

ç¤ºä¾‹:
feat: æ·»åŠ æ‰¹é‡å…³é”®è¯æœç´¢åŠŸèƒ½
fix: ä¿®å¤æ–‡ä»¶å‘½åè¦†ç›–é—®é¢˜
docs: æ›´æ–°é¡¹ç›®äº¤æ¥æ–‡æ¡£
```

---

## ğŸ‰ ç»“è¯­

è¿™ä¸ªé¡¹ç›®ä»ä¸€ä¸ªç®€å•çš„éœ€æ±‚å¼€å§‹,ç»è¿‡å¤šæ¬¡è¿­ä»£,å·²ç»å‘å±•æˆä¸ºä¸€ä¸ªåŠŸèƒ½å®Œå–„çš„æ•°æ®é‡‡é›†å·¥å…·ã€‚

**æ ¸å¿ƒä»·å€¼:**
- å°†å¤æ‚çš„å‘½ä»¤è¡Œå·¥å…·è½¬åŒ–ä¸ºç®€å•æ˜“ç”¨çš„GUI
- æ”¯æŒæ‰¹é‡å¤„ç†,å¤§å¹…æé«˜å·¥ä½œæ•ˆç‡
- æ™ºèƒ½æ–‡ä»¶ç®¡ç†,é¿å…æ•°æ®è¦†ç›–
- å‹å¥½çš„ç”¨æˆ·ä½“éªŒ,é™ä½ä½¿ç”¨é—¨æ§›

**å¼€å‘ç†å¿µ:**
- ç”¨æˆ·éœ€æ±‚é©±åŠ¨
- å¿«é€Ÿè¿­ä»£éªŒè¯
- ä¿æŒç®€å•å¯ç»´æŠ¤
- æ³¨é‡ç”¨æˆ·ä½“éªŒ

**ç»™åç»­å¼€å‘è€…çš„å»ºè®®:**
1. å…ˆç†è§£ç”¨æˆ·éœ€æ±‚,å†åŠ¨æ‰‹å¼€å‘
2. ä¿æŒä»£ç ç®€æ´,é¿å…è¿‡åº¦è®¾è®¡
3. å……åˆ†æµ‹è¯•,ç¡®ä¿ç¨³å®šæ€§
4. åŠæ—¶æ›´æ–°æ–‡æ¡£,æ–¹ä¾¿äº¤æ¥

**ç¥ä½ å¼€å‘é¡ºåˆ©!** ğŸš€

---

## ğŸ” æ·±å…¥æŠ€æœ¯ç»†èŠ‚

### æµè§ˆå™¨ç®¡ç†æœºåˆ¶

#### ç»Ÿä¸€æµè§ˆå™¨å®ä¾‹
**è®¾è®¡ç›®æ ‡:** ç™»å½•å’Œé‡‡é›†ä½¿ç”¨åŒä¸€ä¸ªæµè§ˆå™¨å®ä¾‹,é¿å…é‡å¤ç™»å½•

**å®ç°åŸç†:**
```python
class BrowserManager:
    def __init__(self):
        self.browsers = {}  # å­˜å‚¨å„å¹³å°çš„æµè§ˆå™¨å®ä¾‹
        self.contexts = {}  # å­˜å‚¨æµè§ˆå™¨ä¸Šä¸‹æ–‡
        self.pages = {}     # å­˜å‚¨é¡µé¢å®ä¾‹

    async def get_or_create_browser(self, platform):
        # å¦‚æœå·²å­˜åœ¨,ç›´æ¥è¿”å›
        if platform in self.browsers:
            return self.browsers[platform]

        # åˆ›å»ºæ–°å®ä¾‹
        browser = await self._create_browser(platform)
        self.browsers[platform] = browser
        return browser
```

**å…³é”®ç‚¹:**
- å•ä¾‹æ¨¡å¼ç®¡ç†æµè§ˆå™¨
- ç™»å½•åä¿æŒæµè§ˆå™¨å®ä¾‹
- é‡‡é›†æ—¶å¤ç”¨ç™»å½•çŠ¶æ€
- é¿å…é‡å¤æ‰«ç 

#### Cookieç®¡ç†
**ä¿å­˜ä½ç½®:** `login_data/{platform}_login_info/cookies.json`

**ä¿å­˜æ ¼å¼:**
```json
[
    {
        "name": "sessionid",
        "value": "xxx",
        "domain": ".douyin.com",
        "path": "/",
        "expires": 1234567890
    }
]
```

**åŠ è½½é€»è¾‘:**
```python
async def load_login_state(self, platform):
    cookies_file = f"login_data/{platform}_login_info/cookies.json"

    with open(cookies_file, 'r') as f:
        cookies = json.load(f)

    # æ·»åŠ åˆ°æµè§ˆå™¨ä¸Šä¸‹æ–‡
    await context.add_cookies(cookies)
```

### å¼‚æ­¥ç¼–ç¨‹æ¨¡å‹

#### äº‹ä»¶å¾ªç¯ç®¡ç†
**é—®é¢˜:** GUIåœ¨ä¸»çº¿ç¨‹,çˆ¬è™«éœ€è¦å¼‚æ­¥æ‰§è¡Œ

**è§£å†³æ–¹æ¡ˆ:**
```python
# åˆ›å»ºç‹¬ç«‹çš„äº‹ä»¶å¾ªç¯çº¿ç¨‹
def run_browser_loop(self):
    self.browser_loop = asyncio.new_event_loop()
    asyncio.set_event_loop(self.browser_loop)
    self.browser_loop.run_forever()

# åœ¨GUIçº¿ç¨‹ä¸­æäº¤å¼‚æ­¥ä»»åŠ¡
def start_crawling(self):
    future = asyncio.run_coroutine_threadsafe(
        self._async_crawling(),
        self.browser_loop
    )
    future.result()
```

**å…³é”®ç‚¹:**
- GUIä¸»çº¿ç¨‹ä¸é˜»å¡
- æµè§ˆå™¨æ“ä½œåœ¨ç‹¬ç«‹çº¿ç¨‹
- é€šè¿‡FutureåŒæ­¥ç»“æœ

#### å¹¶å‘æ§åˆ¶
**é—®é¢˜:** é¿å…åŒæ—¶é‡‡é›†è¿‡å¤šå¯¼è‡´è¢«é™åˆ¶

**è§£å†³æ–¹æ¡ˆ:**
```python
# ä½¿ç”¨ä¿¡å·é‡æ§åˆ¶å¹¶å‘
semaphore = asyncio.Semaphore(3)  # æœ€å¤š3ä¸ªå¹¶å‘

async def crawl_with_limit(video_id):
    async with semaphore:
        await crawl_video(video_id)
```

### æ•°æ®å¤„ç†æµç¨‹

#### CSVåˆ—é¡ºåºç®¡ç†
**é—®é¢˜:** ç¡®ä¿CSVåˆ—é¡ºåºä¸€è‡´,æ–¹ä¾¿æ•°æ®åˆ†æ

**è§£å†³æ–¹æ¡ˆ:**
```python
class AsyncFileWriter:
    def __init__(self):
        # é¢„å®šä¹‰åˆ—é¡ºåº
        self.column_orders = {
            "comments": [
                "video_title",      # è§†é¢‘æ ‡é¢˜
                "video_url",        # è§†é¢‘é“¾æ¥
                "content",          # è¯„è®ºå†…å®¹
                "comment_id",       # è¯„è®ºID
                "create_time",      # åˆ›å»ºæ—¶é—´
                "nickname",         # ç”¨æˆ·æ˜µç§°
                # ...
            ]
        }

    def _get_ordered_fieldnames(self, item, item_type):
        # æŒ‰é¢„å®šä¹‰é¡ºåºæ’åˆ—
        predefined = self.column_orders.get(item_type, [])
        actual_keys = list(item.keys())

        # å…ˆæ·»åŠ é¢„å®šä¹‰çš„å­—æ®µ
        ordered = [f for f in predefined if f in actual_keys]

        # å†æ·»åŠ å…¶ä»–å­—æ®µ
        remaining = [f for f in actual_keys if f not in predefined]

        return ordered + remaining
```

**å…³é”®ç‚¹:**
- é‡è¦å­—æ®µæ”¾åœ¨å‰é¢
- ä¿æŒé¡ºåºä¸€è‡´
- æ”¯æŒåŠ¨æ€å­—æ®µ

#### æ•°æ®æ¸…æ´—
**é—®é¢˜:** åŸå§‹æ•°æ®åŒ…å«ç‰¹æ®Šå­—ç¬¦,å½±å“CSVæ ¼å¼

**è§£å†³æ–¹æ¡ˆ:**
```python
def clean_data(item):
    # ç§»é™¤æ¢è¡Œç¬¦
    if 'content' in item:
        item['content'] = item['content'].replace('\n', ' ')

    # ç§»é™¤ç‰¹æ®Šå­—ç¬¦
    if 'nickname' in item:
        item['nickname'] = re.sub(r'[^\w\s]', '', item['nickname'])

    return item
```

---

## ğŸ› ï¸ æ•…éšœæ’æŸ¥æŒ‡å—

### å¸¸è§é—®é¢˜è¯Šæ–­

#### é—®é¢˜1: GUIæ— æ³•å¯åŠ¨
**ç—‡çŠ¶:** åŒå‡»start_gui.pyæ²¡æœ‰ååº”

**å¯èƒ½åŸå› :**
1. Pythonç‰ˆæœ¬ä¸å…¼å®¹
2. ä¾èµ–åŒ…æœªå®‰è£…
3. è·¯å¾„é—®é¢˜

**æ’æŸ¥æ­¥éª¤:**
```bash
# 1. æ£€æŸ¥Pythonç‰ˆæœ¬
python --version  # åº”è¯¥æ˜¯3.8+

# 2. æ£€æŸ¥ä¾èµ–
pip list | grep customtkinter
pip list | grep playwright

# 3. æ‰‹åŠ¨å¯åŠ¨æŸ¥çœ‹é”™è¯¯
python start_gui.py
```

**è§£å†³æ–¹æ¡ˆ:**
```bash
# é‡æ–°å®‰è£…ä¾èµ–
pip install -r requirements.txt
playwright install chromium
```

#### é—®é¢˜2: ç™»å½•å¤±è´¥
**ç—‡çŠ¶:** æ‰«ç åæç¤ºç™»å½•å¤±è´¥

**å¯èƒ½åŸå› :**
1. ç½‘ç»œé—®é¢˜
2. æµè§ˆå™¨ç‰ˆæœ¬ä¸å…¼å®¹
3. Cookieä¿å­˜å¤±è´¥

**æ’æŸ¥æ­¥éª¤:**
```python
# æŸ¥çœ‹æ—¥å¿—
logs/gui_YYYYMMDD_HHMMSS.log

# æ£€æŸ¥ç™»å½•ç›®å½•
login_data/dy_login_info/
â”œâ”€â”€ login_info.json  # åº”è¯¥å­˜åœ¨
â””â”€â”€ cookies.json     # åº”è¯¥å­˜åœ¨
```

**è§£å†³æ–¹æ¡ˆ:**
```bash
# 1. æ¸…é™¤æ—§çš„ç™»å½•æ•°æ®
rm -rf login_data/dy_login_info/

# 2. é‡æ–°ç™»å½•
# å¯åŠ¨GUI,ç‚¹å‡»"ç™»å½•æŠ–éŸ³",é‡æ–°æ‰«ç 
```

#### é—®é¢˜3: é‡‡é›†æ— æ•°æ®
**ç—‡çŠ¶:** é‡‡é›†å®Œæˆä½†CSVæ–‡ä»¶ä¸ºç©º

**å¯èƒ½åŸå› :**
1. å…³é”®è¯æ— ç»“æœ
2. ç™»å½•çŠ¶æ€å¤±æ•ˆ
3. å¹³å°é™åˆ¶

**æ’æŸ¥æ­¥éª¤:**
```python
# 1. æ£€æŸ¥æ—¥å¿—
logs/gui_YYYYMMDD_HHMMSS.log

# 2. æ£€æŸ¥é…ç½®
config.KEYWORDS  # å…³é”®è¯æ˜¯å¦æ­£ç¡®
config.CRAWLER_MAX_NOTES_COUNT  # æ•°é‡æ˜¯å¦>0

# 3. æ‰‹åŠ¨æœç´¢éªŒè¯
# åœ¨æŠ–éŸ³APPä¸­æœç´¢ç›¸åŒå…³é”®è¯,çœ‹æ˜¯å¦æœ‰ç»“æœ
```

**è§£å†³æ–¹æ¡ˆ:**
```python
# 1. æ›´æ¢å…³é”®è¯
# 2. é‡æ–°ç™»å½•
# 3. å‡å°‘é‡‡é›†æ•°é‡
```

#### é—®é¢˜4: æ–‡ä»¶å‘½åé”™è¯¯
**ç—‡çŠ¶:** æ–‡ä»¶åä¸ç¬¦åˆé¢„æœŸæ ¼å¼

**å¯èƒ½åŸå› :**
1. ä»£ç ç‰ˆæœ¬ä¸æ˜¯æœ€æ–°
2. é…ç½®å‚æ•°é”™è¯¯

**æ’æŸ¥æ­¥éª¤:**
```bash
# æ£€æŸ¥ä»£ç ç‰ˆæœ¬
git log -1

# åº”è¯¥æ˜¯: 2e61222 V1.2.4
```

**è§£å†³æ–¹æ¡ˆ:**
```bash
# æ‹‰å–æœ€æ–°ä»£ç 
git pull origin main

# é‡å¯GUI
```

### æ—¥å¿—åˆ†æ

#### æ—¥å¿—ä½ç½®
```
logs/gui_YYYYMMDD_HHMMSS.log
```

#### å…³é”®æ—¥å¿—æ ‡è¯†

**æ­£å¸¸æµç¨‹:**
```
[INFO] MediaCrawler GUI å¯åŠ¨
[INFO] âœ… ç™»å½•çŠ¶æ€æœ‰æ•ˆ
[INFO] ğŸš€ å¼€å§‹é‡‡é›†å…³é”®è¯: ç¾é£Ÿæ¢åº—
[INFO] ğŸ”¥ æ­£åœ¨é‡‡é›†ç¬¬1ä¸ªè§†é¢‘: xxx
[INFO] âœ… é‡‡é›†å®Œæˆ
```

**é”™è¯¯æ ‡è¯†:**
```
[ERROR] ç™»å½•å¤±è´¥: xxx
[ERROR] é‡‡é›†å¤±è´¥: xxx
[WARNING] è¶…æ—¶: xxx
```

#### æ—¥å¿—çº§åˆ«
- **INFO:** æ­£å¸¸ä¿¡æ¯
- **WARNING:** è­¦å‘Š(ä¸å½±å“åŠŸèƒ½)
- **ERROR:** é”™è¯¯(å½±å“åŠŸèƒ½)
- **DEBUG:** è°ƒè¯•ä¿¡æ¯(é»˜è®¤ä¸æ˜¾ç¤º)

---

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–å»ºè®®

### å½“å‰æ€§èƒ½æŒ‡æ ‡

**é‡‡é›†é€Ÿåº¦:**
- å•ä¸ªè§†é¢‘è¯„è®º: 10-30ç§’
- 10ä¸ªè§†é¢‘: 2-5åˆ†é’Ÿ
- æ‰¹é‡å…³é”®è¯(3ç»„): 6-15åˆ†é’Ÿ

**èµ„æºå ç”¨:**
- å†…å­˜: 200-500MB
- CPU: 10-30%
- ç£ç›˜: æ¯1000æ¡è¯„è®ºçº¦1MB

### ä¼˜åŒ–æ–¹å‘

#### 1. å‡å°‘æµè§ˆå™¨èµ„æºå ç”¨
```python
# ä½¿ç”¨æ— å¤´æ¨¡å¼
HEADLESS = True

# ç¦ç”¨å›¾ç‰‡åŠ è½½
await context.route("**/*.{png,jpg,jpeg,gif}", lambda route: route.abort())

# ç¦ç”¨CSS
await context.route("**/*.css", lambda route: route.abort())
```

**æ•ˆæœ:** å†…å­˜å‡å°‘30-50%

#### 2. å¹¶å‘é‡‡é›†
```python
# å½“å‰: ä¸²è¡Œé‡‡é›†
for video in videos:
    await crawl_video(video)

# ä¼˜åŒ–: å¹¶å‘é‡‡é›†
tasks = [crawl_video(v) for v in videos]
await asyncio.gather(*tasks)
```

**æ•ˆæœ:** é€Ÿåº¦æå‡2-3å€

**é£é™©:** å®¹æ˜“è¢«å¹³å°é™åˆ¶

#### 3. ç¼“å­˜æœºåˆ¶
```python
# ç¼“å­˜å·²é‡‡é›†çš„è§†é¢‘ID
cached_videos = set()

if video_id in cached_videos:
    skip()
else:
    crawl()
    cached_videos.add(video_id)
```

**æ•ˆæœ:** é¿å…é‡å¤é‡‡é›†

---

## ğŸ” å®‰å…¨ä¸éšç§

### æ•°æ®å®‰å…¨

#### 1. ç™»å½•ä¿¡æ¯ä¿æŠ¤
**å­˜å‚¨ä½ç½®:** `login_data/` (æœ¬åœ°)

**å®‰å…¨æªæ–½:**
- ä¸ä¸Šä¼ åˆ°GitHub(.gitignore)
- ä»…æœ¬åœ°å­˜å‚¨
- å®šæœŸæ¸…ç†è¿‡æœŸæ•°æ®

**å»ºè®®:**
```bash
# .gitignore ä¸­æ·»åŠ 
login_data/
browser_data/
*.log
```

#### 2. Cookieå®‰å…¨
**é£é™©:** Cookieæ³„éœ²å¯èƒ½å¯¼è‡´è´¦å·è¢«ç›—

**é˜²æŠ¤æªæ–½:**
- ä¸åˆ†äº«login_dataç›®å½•
- å®šæœŸæ›´æ¢å¯†ç 
- ä½¿ç”¨å°å·æµ‹è¯•

#### 3. æ•°æ®éšç§
**é‡‡é›†çš„æ•°æ®åŒ…å«:**
- ç”¨æˆ·æ˜µç§°
- è¯„è®ºå†…å®¹
- IPå½’å±åœ°

**åˆè§„å»ºè®®:**
- ä»…ç”¨äºç ”ç©¶å’Œåˆ†æ
- ä¸å…¬å¼€ä¼ æ’­
- éµå®ˆå¹³å°ä½¿ç”¨æ¡æ¬¾

### æ³•å¾‹åˆè§„

#### ä½¿ç”¨å£°æ˜
```
æœ¬å·¥å…·ä»…ä¾›å­¦ä¹ å’Œç ”ç©¶ä½¿ç”¨,ä½¿ç”¨è€…åº”éµå®ˆ:
1. ä¸å¾—ç”¨äºä»»ä½•å•†ä¸šç”¨é€”
2. éµå®ˆç›®æ ‡å¹³å°çš„ä½¿ç”¨æ¡æ¬¾å’Œrobots.txtè§„åˆ™
3. ä¸å¾—è¿›è¡Œå¤§è§„æ¨¡çˆ¬å–æˆ–å¯¹å¹³å°é€ æˆè¿è¥å¹²æ‰°
4. åˆç†æ§åˆ¶è¯·æ±‚é¢‘ç‡
5. ä¸å¾—ç”¨äºä»»ä½•éæ³•æˆ–ä¸å½“çš„ç”¨é€”
```

#### é£é™©æç¤º
- å¤§é‡é‡‡é›†å¯èƒ½è¢«å¹³å°é™åˆ¶
- è¿è§„ä½¿ç”¨å¯èƒ½å¯¼è‡´æ³•å¾‹é£é™©
- å»ºè®®å’¨è¯¢æ³•å¾‹é¡¾é—®

---

## ğŸ“š å­¦ä¹ èµ„æº

### ç›¸å…³æŠ€æœ¯æ–‡æ¡£

#### Playwright
- å®˜æ–¹æ–‡æ¡£: https://playwright.dev/python/
- ä¸­æ–‡æ•™ç¨‹: https://playwright.bootcss.com/

#### CustomTkinter
- GitHub: https://github.com/TomSchimansky/CustomTkinter
- æ–‡æ¡£: https://customtkinter.tomschimansky.com/

#### AsyncIO
- å®˜æ–¹æ–‡æ¡£: https://docs.python.org/3/library/asyncio.html
- æ•™ç¨‹: https://realpython.com/async-io-python/

### æ¨èé˜…è¯»

#### çˆ¬è™«ç›¸å…³
- ã€ŠPythonç½‘ç»œçˆ¬è™«ä»å…¥é—¨åˆ°å®è·µã€‹
- ã€ŠWeb Scraping with Pythonã€‹

#### GUIå¼€å‘
- ã€ŠPython GUIç¼–ç¨‹(Tkinter)ã€‹
- CustomTkinterå®˜æ–¹ç¤ºä¾‹

#### å¼‚æ­¥ç¼–ç¨‹
- ã€Šæµç•…çš„Pythonã€‹ç¬¬18ç« 
- ã€ŠPythonå¹¶å‘ç¼–ç¨‹å®æˆ˜ã€‹

---

# ğŸ”§ æ·±åº¦æŠ€æœ¯è¯¦è§£(æ–°å¼€å‘è€…å¿…è¯»)

> æœ¬ç« èŠ‚å›ç­”æ‰€æœ‰æ–°å¼€å‘è€…å¯èƒ½é‡åˆ°çš„æŠ€æœ¯ç–‘é—®

---

## 1. æµè§ˆå™¨ç®¡ç†è¯¦è§£ â­â­â­

### 1.1 æµè§ˆå™¨å®ä¾‹ç”Ÿå‘½å‘¨æœŸ

**æ ¸å¿ƒåŸåˆ™:** ç™»å½•å’Œé‡‡é›†ä½¿ç”¨åŒä¸€ä¸ªæµè§ˆå™¨å®ä¾‹

```python
# gui_app.py line 76-82
class MediaCrawlerGUI:
    def __init__(self):
        # ç»Ÿä¸€æµè§ˆå™¨ç®¡ç†
        self.shared_context = None  # æµè§ˆå™¨ä¸Šä¸‹æ–‡(åŒ…å«Cookieã€LocalStorage)
        self.shared_page = None  # æµè§ˆå™¨é¡µé¢
        self.playwright = None  # Playwrightå®ä¾‹
        self.browser_ready = False  # æµè§ˆå™¨æ˜¯å¦å°±ç»ª
        self.current_platform = None  # å½“å‰ç™»å½•çš„å¹³å°
```

**ç”Ÿå‘½å‘¨æœŸæµç¨‹:**

```
1. ç”¨æˆ·ç‚¹å‡»"ç™»å½•æŠ–éŸ³"
   â†“
2. åˆ›å»ºæµè§ˆå™¨å®ä¾‹
   - è°ƒç”¨ create_shared_browser(platform="dy")
   - åˆ›å»º Playwright å®ä¾‹
   - å¯åŠ¨æµè§ˆå™¨(CDPæ¨¡å¼æˆ–æ ‡å‡†æ¨¡å¼)
   - åˆ›å»ºæµè§ˆå™¨ä¸Šä¸‹æ–‡(BrowserContext)
   - åˆ›å»ºé¡µé¢(Page)
   - è®¾ç½® browser_ready = True
   - è®¾ç½® current_platform = "dy"
   â†“
3. æ‰§è¡Œç™»å½•
   - æ‰“å¼€ç™»å½•é¡µé¢
   - ç”¨æˆ·æ‰«ç ç™»å½•
   - ä¿å­˜ç™»å½•ä¿¡æ¯(Cookieã€LocalStorageã€SessionStorage)
   - æµè§ˆå™¨å®ä¾‹ä¿æŒè¿è¡Œ
   â†“
4. ç”¨æˆ·ç‚¹å‡»"å¼€å§‹é‡‡é›†"
   - æ£€æŸ¥ browser_ready å’Œ current_platform
   - å¤ç”¨ç°æœ‰æµè§ˆå™¨å®ä¾‹
   - ä¸éœ€è¦é‡æ–°ç™»å½•
   â†“
5. é‡‡é›†å®Œæˆ
   - æµè§ˆå™¨å®ä¾‹ç»§ç»­ä¿æŒè¿è¡Œ
   - å¯ä»¥ç»§ç»­é‡‡é›†å…¶ä»–å…³é”®è¯
   â†“
6. ç”¨æˆ·åˆ‡æ¢å¹³å°æˆ–å…³é—­ç¨‹åº
   - è°ƒç”¨ cleanup_browser()
   - å…³é—­é¡µé¢(Page)
   - å…³é—­æµè§ˆå™¨ä¸Šä¸‹æ–‡(BrowserContext)
   - åœæ­¢Playwright
   - è®¾ç½® browser_ready = False
   - è®¾ç½® current_platform = None
```

**å…³é”®ä»£ç :**

```python
# gui_app.py line 1943-2027
async def create_shared_browser(self, platform: str):
    """ğŸ”¥ åˆ›å»ºç»Ÿä¸€æµè§ˆå™¨å®ä¾‹"""
    try:
        from playwright.async_api import async_playwright
        import config

        # å¯åŠ¨Playwright
        self.playwright = await async_playwright().start()

        # æ ¹æ®CDPé…ç½®é€‰æ‹©å¯åŠ¨æ–¹å¼
        if config.ENABLE_CDP_MODE:
            # CDPæ¨¡å¼:ä½¿ç”¨ç”¨æˆ·çš„Chrome/Edge
            from tools.cdp_browser import CDPBrowserManager
            cdp_manager = CDPBrowserManager()
            self.shared_context = await cdp_manager.launch_and_connect(
                playwright=self.playwright,
                headless=config.CDP_HEADLESS
            )
        else:
            # æ ‡å‡†æ¨¡å¼:ä½¿ç”¨Playwrightçš„Chromium
            chromium = self.playwright.chromium
            user_data_dir = os.path.join(
                os.getcwd(),
                "browser_data",
                f"{platform}_user_data_dir"
            )
            self.shared_context = await chromium.launch_persistent_context(
                user_data_dir=user_data_dir,
                headless=config.HEADLESS,
                viewport={"width": 1920, "height": 1080}
            )

        # åˆ›å»ºé¡µé¢
        self.shared_page = await self.shared_context.new_page()

        # æ ‡è®°æµè§ˆå™¨å°±ç»ª
        self.browser_ready = True
        self.current_platform = platform

        return True
    except Exception as e:
        await self.cleanup_browser()
        return False
```

### 1.2 ç™»å½•çŠ¶æ€ç®¡ç†

**ä¿å­˜ä½ç½®:**
```
login_data/
â”œâ”€â”€ dy_login_info/          # æŠ–éŸ³ç™»å½•ä¿¡æ¯
â”‚   â”œâ”€â”€ cookies.json        # Cookieæ•°æ®
â”‚   â”œâ”€â”€ local_storage.json  # LocalStorageæ•°æ®
â”‚   â”œâ”€â”€ session_storage.json # SessionStorageæ•°æ®
â”‚   â””â”€â”€ login_info.json     # ç™»å½•å…ƒä¿¡æ¯
â”œâ”€â”€ xhs_login_info/         # å°çº¢ä¹¦ç™»å½•ä¿¡æ¯
â”œâ”€â”€ bili_login_info/        # Bç«™ç™»å½•ä¿¡æ¯
â””â”€â”€ zhihu_login_info/       # çŸ¥ä¹ç™»å½•ä¿¡æ¯
```

**ä¿å­˜é€»è¾‘(gui_app.py line 2092-2143):**

```python
async def save_login_info(self, platform: str):
    """ä¿å­˜å½“å‰ç™»å½•ä¿¡æ¯"""
    import json
    import time

    # 1. ä¿å­˜Cookies
    cookies = await self.shared_context.cookies()
    cookies_file = os.path.join(self.login_data_dir, "cookies.json")
    with open(cookies_file, 'w', encoding='utf-8') as f:
        json.dump(cookies, f, ensure_ascii=False, indent=2)

    # 2. ä¿å­˜LocalStorage
    local_storage = await self.shared_page.evaluate("""
        () => {
            let storage = {};
            for (let i = 0; i < localStorage.length; i++) {
                let key = localStorage.key(i);
                storage[key] = localStorage.getItem(key);
            }
            return storage;
        }
    """)
    local_storage_file = os.path.join(self.login_data_dir, "local_storage.json")
    with open(local_storage_file, 'w', encoding='utf-8') as f:
        json.dump(local_storage, f, ensure_ascii=False, indent=2)

    # 3. ä¿å­˜SessionStorage
    session_storage = await self.shared_page.evaluate("""
        () => {
            let storage = {};
            for (let i = 0; i < sessionStorage.length; i++) {
                let key = sessionStorage.key(i);
                storage[key] = sessionStorage.getItem(key);
            }
            return storage;
        }
    """)
    session_storage_file = os.path.join(self.login_data_dir, "session_storage.json")
    with open(session_storage_file, 'w', encoding='utf-8') as f:
        json.dump(session_storage, f, ensure_ascii=False, indent=2)

    # 4. ä¿å­˜ç™»å½•å…ƒä¿¡æ¯
    login_info = {
        "platform": platform,
        "login_time": time.time(),
        "login_date": time.strftime("%Y-%m-%d %H:%M:%S"),
        "cookies_count": len(cookies),
        "local_storage_count": len(local_storage),
        "session_storage_count": len(session_storage)
    }
    info_file = os.path.join(self.login_data_dir, "login_info.json")
    with open(info_file, 'w', encoding='utf-8') as f:
        json.dump(login_info, f, ensure_ascii=False, indent=2)
```

**åŠ è½½é€»è¾‘(gui_app.py line 2021-2090):**

```python
async def load_saved_login_info(self, platform: str):
    """åŠ è½½å·²ä¿å­˜çš„ç™»å½•ä¿¡æ¯åˆ°æµè§ˆå™¨"""
    import json

    # 1. åŠ è½½Cookies
    cookies_file = os.path.join(self.login_data_dir, "cookies.json")
    if os.path.exists(cookies_file):
        with open(cookies_file, 'r', encoding='utf-8') as f:
            cookies = json.load(f)
            await self.shared_context.add_cookies(cookies)

    # 2. åŠ è½½LocalStorage
    local_storage_file = os.path.join(self.login_data_dir, "local_storage.json")
    if os.path.exists(local_storage_file):
        with open(local_storage_file, 'r', encoding='utf-8') as f:
            local_storage = json.load(f)
            await self.shared_page.evaluate("""
                (storage) => {
                    for (let key in storage) {
                        localStorage.setItem(key, storage[key]);
                    }
                }
            """, local_storage)

    # 3. åŠ è½½SessionStorage
    session_storage_file = os.path.join(self.login_data_dir, "session_storage.json")
    if os.path.exists(session_storage_file):
        with open(session_storage_file, 'r', encoding='utf-8') as f:
            session_storage = json.load(f)
            await self.shared_page.evaluate("""
                (storage) => {
                    for (let key in storage) {
                        sessionStorage.setItem(key, storage[key]);
                    }
                }
            """, session_storage)
```

**Cookieæœ‰æ•ˆæœŸ:**
- é€šå¸¸30å¤©
- è¿‡æœŸåéœ€è¦é‡æ–°ç™»å½•
- å¯ä»¥é€šè¿‡`login_info.json`ä¸­çš„`login_time`åˆ¤æ–­æ˜¯å¦è¿‡æœŸ

**ç™»å½•çŠ¶æ€æ£€æŸ¥:**

```python
def check_saved_login_status(self, platform: str):
    """æ£€æŸ¥å·²ä¿å­˜çš„ç™»å½•çŠ¶æ€"""
    import json
    import time

    login_data_dir = os.path.join(
        os.getcwd(),
        "login_data",
        f"{platform}_login_info"
    )

    info_file = os.path.join(login_data_dir, "login_info.json")
    if not os.path.exists(info_file):
        return None

    with open(info_file, 'r', encoding='utf-8') as f:
        login_info = json.load(f)

    # æ£€æŸ¥æ˜¯å¦è¿‡æœŸ(30å¤©)
    login_time = login_info.get("login_time", 0)
    current_time = time.time()
    days_passed = (current_time - login_time) / 86400

    if days_passed > 30:
        return "å·²è¿‡æœŸ"
    else:
        return f"æœ‰æ•ˆ({int(30 - days_passed)}å¤©)"
```

### 1.3 æµè§ˆå™¨åˆ‡æ¢å¹³å°é€»è¾‘

**é—®é¢˜:** å¦‚æœæˆ‘ç™»å½•äº†æŠ–éŸ³,ç„¶ååˆ‡æ¢åˆ°å°çº¢ä¹¦,ä¼šå‘ç”Ÿä»€ä¹ˆ?

**ç­”æ¡ˆ:**

```python
# gui_app.py line 1293-1302
if self.current_platform != platform:
    messagebox.showwarning(
        "å¹³å°ä¸åŒ¹é…",
        f"å½“å‰å·²ç™»å½•å¹³å°:{self.current_platform}\n"
        f"è¦é‡‡é›†çš„å¹³å°:{platform}\n\n"
        f"è¯·æ‰§è¡Œä»¥ä¸‹æ“ä½œä¹‹ä¸€:\n"
        f"1. åœ¨'å¹³å°é…ç½®'ä¸­é€‰æ‹©'{self.current_platform}'å¹³å°\n"
        f"2. æˆ–åœ¨'ç™»å½•ç®¡ç†'ä¸­ç™»å½•'{platform}'å¹³å°"
    )
    return
```

**æµç¨‹:**
```
1. ç”¨æˆ·ç™»å½•æŠ–éŸ³
   - current_platform = "dy"
   - browser_ready = True

2. ç”¨æˆ·åˆ‡æ¢åˆ°å°çº¢ä¹¦å¹¶ç‚¹å‡»"å¼€å§‹é‡‡é›†"
   - æ£€æŸ¥: current_platform("dy") != platform("xhs")
   - å¼¹å‡ºè­¦å‘Š,é˜»æ­¢é‡‡é›†

3. ç”¨æˆ·éœ€è¦:
   é€‰é¡¹A: åˆ‡æ¢å›æŠ–éŸ³å¹³å°
   é€‰é¡¹B: ç™»å½•å°çº¢ä¹¦(ä¼šå…³é—­æŠ–éŸ³æµè§ˆå™¨,åˆ›å»ºæ–°çš„å°çº¢ä¹¦æµè§ˆå™¨)
```

**ä¸ºä»€ä¹ˆä¸èƒ½åŒæ—¶ä¿æŒå¤šä¸ªå¹³å°çš„æµè§ˆå™¨?**
- å†…å­˜å ç”¨å¤§(æ¯ä¸ªæµè§ˆå™¨çº¦500MB)
- ç®¡ç†å¤æ‚
- ç”¨æˆ·é€šå¸¸åªé‡‡é›†ä¸€ä¸ªå¹³å°

### 1.4 æµè§ˆå™¨å´©æºƒå¤„ç†

**é—®é¢˜:** å¦‚æœé‡‡é›†ä¸­é€”æµè§ˆå™¨å´©æºƒ,ä¼šå‘ç”Ÿä»€ä¹ˆ?

**ç­”æ¡ˆ:**

```python
# ç»Ÿä¸€æµè§ˆå™¨é‡‡é›†å™¨.py line 293-320
async def start_unified_douyin_crawling(self):
    """ä½¿ç”¨ç»Ÿä¸€æµè§ˆå™¨è¿›è¡ŒæŠ–éŸ³é‡‡é›†"""
    try:
        # æ ‡è®°è¿™æ˜¯ç»Ÿä¸€æµè§ˆå™¨æ¨¡å¼,ä¸è¦å…³é—­æµè§ˆå™¨ä¸Šä¸‹æ–‡
        self.crawler._is_unified_browser = True

        # ç›´æ¥è®¾ç½®æµè§ˆå™¨ä¸Šä¸‹æ–‡
        self.crawler.browser_context = self.shared_context
        self.crawler.context_page = self.shared_page

        # æ‰§è¡Œé‡‡é›†
        await self.crawler.start()

    except Exception as e:
        print(f"âŒ é‡‡é›†å¤±è´¥: {e}")
        # æµè§ˆå™¨å®ä¾‹ä»ç„¶ä¿æŒè¿è¡Œ
        # ç”¨æˆ·å¯ä»¥é‡è¯•
```

**å´©æºƒæ¢å¤:**
```
1. é‡‡é›†å¤±è´¥
   - å¼‚å¸¸è¢«æ•è·
   - æµè§ˆå™¨å®ä¾‹ä¿æŒè¿è¡Œ
   - GUIæ˜¾ç¤ºé”™è¯¯ä¿¡æ¯

2. ç”¨æˆ·å¯ä»¥:
   - é‡æ–°ç‚¹å‡»"å¼€å§‹é‡‡é›†"(å¤ç”¨ç°æœ‰æµè§ˆå™¨)
   - æˆ–é‡æ–°ç™»å½•(åˆ›å»ºæ–°æµè§ˆå™¨)
```

---

## 2. æ•°æ®æµè¯¦è§£ â­â­â­

### 2.1 å®Œæ•´æ•°æ®æµå‘

```
ç”¨æˆ·ç‚¹å‡»"å¼€å§‹é‡‡é›†"
    â†“
GUIçº¿ç¨‹: start_crawling()
    â†“
åå°çº¿ç¨‹: run_crawler_task()
    â†“
æ›´æ–°é…ç½®: update_config()
    â”œâ”€ config.PLATFORM = "dy"
    â”œâ”€ config.CRAWLER_TYPE = "search"
    â”œâ”€ config.KEYWORDS = "ç¾é£Ÿ"
    â””â”€ config.CRAWLER_MAX_NOTES_COUNT = 10
    â†“
è°ƒç”¨ç»Ÿä¸€æµè§ˆå™¨é‡‡é›†å™¨: run_unified_crawler()
    â†“
å¼‚æ­¥äº‹ä»¶å¾ªç¯: asyncio.run_coroutine_threadsafe()
    â†“
ç»Ÿä¸€æµè§ˆå™¨é‡‡é›†å™¨: async_douyin_crawler()
    â”œâ”€ è®¾ç½®é…ç½®
    â”œâ”€ é‡ç½®store
    â”œâ”€ åˆ›å»ºçˆ¬è™«å®ä¾‹
    â””â”€ å¼€å§‹é‡‡é›†
    â†“
æŠ–éŸ³çˆ¬è™«: DouYinCrawler.start()
    â”œâ”€ æœç´¢å…³é”®è¯
    â”œâ”€ è·å–è§†é¢‘åˆ—è¡¨
    â”œâ”€ éå†è§†é¢‘
    â”‚   â”œâ”€ è·å–è§†é¢‘è¯¦æƒ…
    â”‚   â”œâ”€ ä¿å­˜è§†é¢‘ä¿¡æ¯
    â”‚   â””â”€ è·å–è¯„è®º
    â”‚       â”œâ”€ è·å–ä¸€çº§è¯„è®º
    â”‚       â”œâ”€ è·å–äºŒçº§è¯„è®º(å¦‚æœå¯ç”¨)
    â”‚       â””â”€ ä¿å­˜è¯„è®º
    â””â”€ å®Œæˆ
    â†“
æ•°æ®å­˜å‚¨: DouyinStore
    â”œâ”€ é€‰æ‹©å­˜å‚¨æ–¹å¼(CSV/JSON/DB)
    â”œâ”€ è°ƒç”¨AsyncFileWriter
    â””â”€ å†™å…¥æ–‡ä»¶
    â†“
æ–‡ä»¶è¾“å‡º: data/douyin/
    â”œâ”€ ç¾é£Ÿ_20251103_143052_comments.csv
    â””â”€ ç¾é£Ÿ_20251103_143052_contents.json
    â†“
GUIæ›´æ–°: update_progress()
    â”œâ”€ æ›´æ–°è¿›åº¦æ¡
    â”œâ”€ æ›´æ–°çŠ¶æ€æ–‡æœ¬
    â””â”€ æ˜¾ç¤ºå®Œæˆæ¶ˆæ¯
```

### 2.2 å…³é”®æ•°æ®ç»“æ„

**è§†é¢‘ä¿¡æ¯(content_item):**
```python
{
    "aweme_id": "7123456789",  # è§†é¢‘ID
    "title": "ç¾é£Ÿæ¢åº—",  # æ ‡é¢˜
    "desc": "è¿™å®¶åº—å¤ªå¥½åƒäº†",  # æè¿°
    "create_time": 1699000000,  # åˆ›å»ºæ—¶é—´
    "user_id": "123456",  # ç”¨æˆ·ID
    "nickname": "ç¾é£Ÿåšä¸»",  # æ˜µç§°
    "avatar": "https://...",  # å¤´åƒ
    "liked_count": 1000,  # ç‚¹èµæ•°
    "comment_count": 100,  # è¯„è®ºæ•°
    "share_count": 50,  # åˆ†äº«æ•°
    "video_url": "https://...",  # è§†é¢‘URL
}
```

**è¯„è®ºä¿¡æ¯(comment_item):**
```python
{
    "comment_id": "789456123",  # è¯„è®ºID
    "aweme_id": "7123456789",  # è§†é¢‘ID
    "content": "å¤ªå¥½åƒäº†",  # è¯„è®ºå†…å®¹
    "create_time": 1699000100,  # åˆ›å»ºæ—¶é—´
    "user_id": "654321",  # ç”¨æˆ·ID
    "nickname": "åƒè´§",  # æ˜µç§°
    "avatar": "https://...",  # å¤´åƒ
    "liked_count": 10,  # ç‚¹èµæ•°
    "reply_count": 2,  # å›å¤æ•°
    "parent_comment_id": "",  # çˆ¶è¯„è®ºID(äºŒçº§è¯„è®º)
}
```

### 2.3 æ•°æ®å†™å…¥æ—¶æœº

**é—®é¢˜:** æ•°æ®ä»€ä¹ˆæ—¶å€™å†™å…¥æ–‡ä»¶?æ˜¯é‡‡é›†å®Œæ‰€æœ‰æ•°æ®åä¸€æ¬¡æ€§å†™å…¥,è¿˜æ˜¯è¾¹é‡‡é›†è¾¹å†™å…¥?

**ç­”æ¡ˆ:** è¾¹é‡‡é›†è¾¹å†™å…¥(å®æ—¶å†™å…¥)

```python
# store/douyin/_store_impl.py line 57-69
async def store_comment(self, comment_item: Dict):
    """å­˜å‚¨è¯„è®º(å®æ—¶å†™å…¥)"""
    await self.file_writer.write_to_csv(
        item=comment_item,
        item_type="comments"
    )
```

**å†™å…¥æµç¨‹:**
```
1. è·å–ä¸€æ¡è¯„è®º
   â†“
2. ç«‹å³è°ƒç”¨ store_comment()
   â†“
3. AsyncFileWriter.write_to_csv()
   â”œâ”€ è·å–æ–‡ä»¶é”(é˜²æ­¢å¹¶å‘å†™å…¥å†²çª)
   â”œâ”€ æ‰“å¼€æ–‡ä»¶(è¿½åŠ æ¨¡å¼)
   â”œâ”€ å†™å…¥ä¸€è¡Œ
   â”œâ”€ å…³é—­æ–‡ä»¶
   â””â”€ é‡Šæ”¾æ–‡ä»¶é”
   â†“
4. ç»§ç»­è·å–ä¸‹ä¸€æ¡è¯„è®º
```

**ä¼˜åŠ¿:**
- âœ… å³ä½¿ç¨‹åºå´©æºƒ,å·²é‡‡é›†çš„æ•°æ®ä¸ä¼šä¸¢å¤±
- âœ… å¯ä»¥å®æ—¶æŸ¥çœ‹é‡‡é›†è¿›åº¦
- âœ… å†…å­˜å ç”¨å°

**åŠ£åŠ¿:**
- âš ï¸ é¢‘ç¹IOæ“ä½œ,æ€§èƒ½ç¨æ…¢
- âš ï¸ æ–‡ä»¶é”å¯èƒ½æˆä¸ºç“¶é¢ˆ(å¹¶å‘é‡‡é›†æ—¶)

---

## 3. å¼‚æ­¥ç¼–ç¨‹è¯¦è§£ â­â­â­

### 3.1 äº‹ä»¶å¾ªç¯æ¶æ„

**æ ¸å¿ƒé—®é¢˜:** GUIåœ¨ä¸»çº¿ç¨‹,çˆ¬è™«éœ€è¦å¼‚æ­¥æ‰§è¡Œ,å¦‚ä½•åè°ƒ?

**è§£å†³æ–¹æ¡ˆ:** ç‹¬ç«‹çš„äº‹ä»¶å¾ªç¯çº¿ç¨‹

```python
# gui_app.py line 1063-1092
# åˆ›å»ºæ–°çš„äº‹ä»¶å¾ªç¯å¹¶åœ¨åå°æŒç»­è¿è¡Œ
if not hasattr(self, 'browser_loop') or self.browser_loop is None:
    self.browser_loop = asyncio.new_event_loop()

    # åœ¨æ–°çº¿ç¨‹ä¸­å¯åŠ¨äº‹ä»¶å¾ªç¯,è®©å®ƒæŒç»­è¿è¡Œ
    def run_loop():
        asyncio.set_event_loop(self.browser_loop)
        self.browser_loop.run_forever()  # æŒç»­è¿è¡Œ

    self.loop_thread = threading.Thread(target=run_loop, daemon=True)
    self.loop_thread.start()

# ä½¿ç”¨ run_coroutine_threadsafe åœ¨äº‹ä»¶å¾ªç¯ä¸­è¿è¡Œç™»å½•ä»»åŠ¡
future = asyncio.run_coroutine_threadsafe(
    self.perform_login(platform),
    self.browser_loop
)

# ç­‰å¾…ç™»å½•å®Œæˆ
future.result(timeout=300)
```

**æ¶æ„å›¾:**

```
ä¸»çº¿ç¨‹(GUIçº¿ç¨‹)
â”œâ”€ CustomTkinter GUI
â”œâ”€ äº‹ä»¶å¤„ç†
â””â”€ ç”¨æˆ·äº¤äº’

åå°çº¿ç¨‹(äº‹ä»¶å¾ªç¯çº¿ç¨‹)
â”œâ”€ asyncio.new_event_loop()
â”œâ”€ loop.run_forever()
â””â”€ æ‰§è¡Œå¼‚æ­¥ä»»åŠ¡
    â”œâ”€ æµè§ˆå™¨æ“ä½œ
    â”œâ”€ ç½‘ç»œè¯·æ±‚
    â””â”€ æ•°æ®é‡‡é›†

é€šä¿¡æ–¹å¼:
asyncio.run_coroutine_threadsafe(coroutine, loop)
```

### 3.2 çº¿ç¨‹åä½œæœºåˆ¶

**GUIçº¿ç¨‹ â†’ äº‹ä»¶å¾ªç¯çº¿ç¨‹:**

```python
# æäº¤å¼‚æ­¥ä»»åŠ¡
future = asyncio.run_coroutine_threadsafe(
    self.async_douyin_crawler(...),
    self.browser_loop
)

# ç­‰å¾…ä»»åŠ¡å®Œæˆ
future.result()  # é˜»å¡,ç›´åˆ°ä»»åŠ¡å®Œæˆ
```

**äº‹ä»¶å¾ªç¯çº¿ç¨‹ â†’ GUIçº¿ç¨‹:**

```python
# æ›´æ–°GUI(å¿…é¡»åœ¨ä¸»çº¿ç¨‹æ‰§è¡Œ)
self.root.after(0, lambda: self.update_progress(current, total, content_type))
self.root.after(0, lambda: self.update_status(f"æ­£åœ¨é‡‡é›†ç¬¬{current}ä¸ª..."))
```

**ä¸ºä»€ä¹ˆä½¿ç”¨`root.after(0, ...)`?**
- Tkinterä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„
- æ‰€æœ‰GUIæ“ä½œå¿…é¡»åœ¨ä¸»çº¿ç¨‹æ‰§è¡Œ
- `root.after(0, callback)`å°†å›è°ƒå‡½æ•°è°ƒåº¦åˆ°ä¸»çº¿ç¨‹çš„äº‹ä»¶é˜Ÿåˆ—

### 3.3 å¼‚æ­¥ä»»åŠ¡å–æ¶ˆæœºåˆ¶

**é—®é¢˜:** ç”¨æˆ·ç‚¹å‡»"åœæ­¢é‡‡é›†",å¦‚ä½•å®‰å…¨åœæ­¢å¼‚æ­¥ä»»åŠ¡?

**ç­”æ¡ˆ:** ä½¿ç”¨åœæ­¢æ ‡å¿—(stop_flag)

```python
# gui_app.py line 1322-1331
def stop_crawling(self):
    """åœæ­¢é‡‡é›†"""
    self.stop_flag = True  # è®¾ç½®åœæ­¢æ ‡å¿—
    self.update_status("æ­£åœ¨åœæ­¢é‡‡é›†...")

    # ç­‰å¾…çº¿ç¨‹ç»“æŸ
    if hasattr(self, 'task_thread') and self.task_thread.is_alive():
        self.task_thread.join(timeout=2.0)

    self.reset_ui_state()
```

**é‡‡é›†å¾ªç¯ä¸­æ£€æŸ¥åœæ­¢æ ‡å¿—:**

```python
# gui_app.py line 1513-1540
for index, input_item in enumerate(input_list, 1):
    if self.stop_flag:  # æ£€æŸ¥åœæ­¢æ ‡å¿—
        print(f"â¹ï¸ ç”¨æˆ·åœæ­¢é‡‡é›†")
        break

    # æ‰§è¡Œé‡‡é›†
    await self.async_douyin_crawler(...)
```

**æ•°æ®å®Œæ•´æ€§ä¿è¯:**
```
1. ç”¨æˆ·ç‚¹å‡»"åœæ­¢"
   â†“
2. è®¾ç½® stop_flag = True
   â†“
3. å½“å‰æ­£åœ¨é‡‡é›†çš„è§†é¢‘ç»§ç»­å®Œæˆ
   â”œâ”€ è§†é¢‘è¯¦æƒ…å·²ä¿å­˜
   â”œâ”€ è¯„è®ºå·²ä¿å­˜
   â””â”€ æ–‡ä»¶å·²å†™å…¥
   â†“
4. ä¸‹ä¸€ä¸ªè§†é¢‘ä¸å†é‡‡é›†
   â†“
5. å¾ªç¯é€€å‡º,ä»»åŠ¡ç»“æŸ
```

**ä¸ºä»€ä¹ˆä¸ä½¿ç”¨`asyncio.Task.cancel()`?**
- `cancel()`ä¼šç«‹å³ä¸­æ–­ä»»åŠ¡
- å¯èƒ½å¯¼è‡´æ•°æ®ä¸å®Œæ•´
- æ–‡ä»¶å¯èƒ½æŸå
- ä½¿ç”¨`stop_flag`å¯ä»¥ä¼˜é›…é€€å‡º

---

## 4. æ–‡ä»¶å‘½åé€»è¾‘è¯¦è§£ â­â­

### 4.1 æ–‡ä»¶å‘½åè§„åˆ™

**ä»£ç ä½ç½®:** `tools/async_file_writer.py` line 122-158

**ä¸‰ç§æ¨¡å¼çš„å‘½åè§„åˆ™:**

**æ¨¡å¼1: å…³é”®è¯æœç´¢(search)**
```python
# æ ¼å¼: {å…³é”®è¯}_{æ—¶é—´æˆ³}_{ç±»å‹}.{æ ¼å¼}
# ç¤ºä¾‹: ç¾é£Ÿæ¢åº—_20251103_143052_comments.csv

def _get_file_path(self, file_type: str, item_type: str):
    if self.crawler_type == "search":
        # è·å–å…³é”®è¯
        keywords = config.KEYWORDS
        # æ¸…ç†ç‰¹æ®Šå­—ç¬¦
        clean_keywords = self._clean_filename(keywords)
        # ç”Ÿæˆæ—¶é—´æˆ³
        timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
        # ç»„åˆæ–‡ä»¶å
        filename = f"{clean_keywords}_{timestamp}_{item_type}.{file_type}"
```

**æ¨¡å¼2: é“¾æ¥æœç´¢(detail)**
```python
# æ ¼å¼: {æ—¶é—´æˆ³}_{è§†é¢‘æ•°é‡}æ¡è§†é¢‘_{ç±»å‹}.{æ ¼å¼}
# ç¤ºä¾‹: 20251103_143052_5æ¡è§†é¢‘_comments.csv

def _get_file_path(self, file_type: str, item_type: str):
    if self.crawler_type == "detail":
        timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
        video_count = len(config.DY_SPECIFIED_ID_LIST)
        filename = f"{timestamp}_{video_count}æ¡è§†é¢‘_{item_type}.{file_type}"
```

**æ¨¡å¼3: åˆ›ä½œè€…æœç´¢(creator)**
```python
# æ ¼å¼: {åˆ›ä½œè€…æ˜µç§°}_{è§†é¢‘æ•°é‡}æ¡è§†é¢‘_{ç±»å‹}.{æ ¼å¼}
# ç¤ºä¾‹: ç¾é£Ÿåšä¸»_10æ¡è§†é¢‘_comments.csv

def _get_file_path(self, file_type: str, item_type: str):
    if self.crawler_type == "creator":
        # ä»ç¬¬ä¸€æ¡æ•°æ®ä¸­è·å–åˆ›ä½œè€…æ˜µç§°
        nickname = self._get_creator_nickname()
        clean_nickname = self._clean_filename(nickname)
        video_count = self._get_video_count()
        filename = f"{clean_nickname}_{video_count}æ¡è§†é¢‘_{item_type}.{file_type}"
```

### 4.2 ç‰¹æ®Šå­—ç¬¦å¤„ç†

**é—®é¢˜:** å¦‚æœå…³é”®è¯åŒ…å«ç‰¹æ®Šå­—ç¬¦(å¦‚`/\:*?"<>|`),ä¼šå‘ç”Ÿä»€ä¹ˆ?

**ç­”æ¡ˆ:** è‡ªåŠ¨æ¸…ç†ç‰¹æ®Šå­—ç¬¦

```python
def _clean_filename(self, filename: str) -> str:
    """æ¸…ç†æ–‡ä»¶åä¸­çš„éæ³•å­—ç¬¦"""
    # Windowsæ–‡ä»¶åéæ³•å­—ç¬¦
    illegal_chars = r'[<>:"/\\|?*]'
    # æ›¿æ¢ä¸ºä¸‹åˆ’çº¿
    clean_name = re.sub(illegal_chars, '_', filename)
    # å»é™¤é¦–å°¾ç©ºæ ¼
    clean_name = clean_name.strip()
    # é™åˆ¶é•¿åº¦(Windowsè·¯å¾„æœ€å¤§260å­—ç¬¦)
    if len(clean_name) > 100:
        clean_name = clean_name[:100]
    return clean_name
```

**ç¤ºä¾‹:**
```
åŸå§‹å…³é”®è¯: "ç¾é£Ÿ/æ¢åº—:2024"
æ¸…ç†å: "ç¾é£Ÿ_æ¢åº—_2024"

åŸå§‹å…³é”®è¯: "æµ‹è¯•<>?*"
æ¸…ç†å: "æµ‹è¯•____"
```

### 4.3 æ–‡ä»¶åå†²çªå¤„ç†

**é—®é¢˜:** å¦‚æœåŒä¸€ä¸ªå…³é”®è¯åœ¨åŒä¸€ç§’å†…é‡‡é›†ä¸¤æ¬¡,æ–‡ä»¶åä¼šå†²çªå—?

**ç­”æ¡ˆ:** ä¼šå†²çª,åä¸€æ¬¡ä¼šè¦†ç›–å‰ä¸€æ¬¡

**åŸå› :**
- æ—¶é—´æˆ³ç²¾åº¦åªåˆ°ç§’
- æ²¡æœ‰è‡ªåŠ¨æ·»åŠ åºå·

**è§£å†³æ–¹æ³•(å¦‚æœéœ€è¦):**

```python
def _get_file_path(self, file_type: str, item_type: str):
    base_filename = f"{clean_keywords}_{timestamp}_{item_type}"
    filename = f"{base_filename}.{file_type}"
    file_path = os.path.join(self.output_dir, filename)

    # å¦‚æœæ–‡ä»¶å·²å­˜åœ¨,æ·»åŠ åºå·
    counter = 1
    while os.path.exists(file_path):
        filename = f"{base_filename}_{counter}.{file_type}"
        file_path = os.path.join(self.output_dir, filename)
        counter += 1

    return file_path
```

**å½“å‰è¡Œä¸º:**
```
ç¬¬1æ¬¡é‡‡é›†: ç¾é£Ÿ_20251103_143052_comments.csv (åˆ›å»º)
ç¬¬2æ¬¡é‡‡é›†: ç¾é£Ÿ_20251103_143052_comments.csv (è¦†ç›–)
```

**ä¿®æ”¹åè¡Œä¸º:**
```
ç¬¬1æ¬¡é‡‡é›†: ç¾é£Ÿ_20251103_143052_comments.csv
ç¬¬2æ¬¡é‡‡é›†: ç¾é£Ÿ_20251103_143052_1_comments.csv
ç¬¬3æ¬¡é‡‡é›†: ç¾é£Ÿ_20251103_143052_2_comments.csv
```

### 4.4 è¾“å‡ºç›®å½•ç»“æ„

```
data/
â”œâ”€â”€ douyin/                    # æŠ–éŸ³æ•°æ®
â”‚   â”œâ”€â”€ ç¾é£Ÿ_20251103_143052_comments.csv
â”‚   â”œâ”€â”€ ç¾é£Ÿ_20251103_143052_contents.json
â”‚   â””â”€â”€ æ—…æ¸¸_20251103_150000_comments.csv
â”œâ”€â”€ xhs/                       # å°çº¢ä¹¦æ•°æ®
â”œâ”€â”€ bilibili/                  # Bç«™æ•°æ®
â””â”€â”€ zhihu/                     # çŸ¥ä¹æ•°æ®
```

**è‡ªå®šä¹‰è¾“å‡ºç›®å½•:**

```python
# ç»Ÿä¸€æµè§ˆå™¨é‡‡é›†å™¨.py line 212-213
if output_dir:
    DouyinStoreFactory.set_output_dir(output_dir)
```

---

## 5. é”™è¯¯å¤„ç†æœºåˆ¶ â­â­

### 5.1 é”™è¯¯ç±»å‹

**1. ç½‘ç»œé”™è¯¯**
```python
# ç—‡çŠ¶: è¯·æ±‚è¶…æ—¶ã€è¿æ¥å¤±è´¥
# åŸå› : ç½‘ç»œä¸ç¨³å®šã€å¹³å°é™æµ
# å¤„ç†: è‡ªåŠ¨é‡è¯•3æ¬¡,å¤±è´¥åè·³è¿‡

try:
    response = await self.dy_client.get_video_info(video_id)
except httpx.TimeoutException:
    utils.logger.error(f"è·å–è§†é¢‘{video_id}è¶…æ—¶,é‡è¯•...")
    await asyncio.sleep(2)
    # é‡è¯•é€»è¾‘
```

**2. ç™»å½•å¤±æ•ˆ**
```python
# ç—‡çŠ¶: è¿”å›401ã€éœ€è¦ç™»å½•
# åŸå› : Cookieè¿‡æœŸã€è¢«è¸¢ä¸‹çº¿
# å¤„ç†: æç¤ºç”¨æˆ·é‡æ–°ç™»å½•

if not await self.dy_client.pong():
    print("âš ï¸ ç™»å½•çŠ¶æ€å¤±æ•ˆ,è¯·é‡æ–°ç™»å½•")
    return
```

**3. åçˆ¬é™åˆ¶**
```python
# ç—‡çŠ¶: è¿”å›éªŒè¯ç ã€IPè¢«å°
# åŸå› : è¯·æ±‚é¢‘ç‡è¿‡é«˜
# å¤„ç†: å¢åŠ å»¶è¿Ÿã€ä½¿ç”¨ä»£ç†

# config/base_config.py
CRAWLER_MAX_SLEEP_SEC = 2  # æ¯æ¬¡è¯·æ±‚é—´éš”2ç§’
ENABLE_IP_PROXY = True  # å¯ç”¨ä»£ç†
```

**4. æ•°æ®è§£æé”™è¯¯**
```python
# ç—‡çŠ¶: KeyErrorã€JSONè§£æå¤±è´¥
# åŸå› : å¹³å°APIå˜æ›´
# å¤„ç†: è®°å½•é”™è¯¯,è·³è¿‡è¯¥æ¡æ•°æ®

try:
    video_info = response.json()
    title = video_info['aweme_detail']['desc']
except KeyError as e:
    utils.logger.error(f"æ•°æ®è§£æå¤±è´¥: {e}")
    continue
```

### 5.2 é”™è¯¯ç è¯´æ˜

**HTTPçŠ¶æ€ç :**

| çŠ¶æ€ç  | å«ä¹‰ | å¤„ç†æ–¹æ³• |
|--------|------|----------|
| 200 | æˆåŠŸ | æ­£å¸¸å¤„ç† |
| 401 | æœªç™»å½• | é‡æ–°ç™»å½• |
| 403 | ç¦æ­¢è®¿é—® | æ£€æŸ¥Cookieã€æ›´æ¢IP |
| 429 | è¯·æ±‚è¿‡å¤š | å¢åŠ å»¶è¿Ÿã€é™ä½å¹¶å‘ |
| 500 | æœåŠ¡å™¨é”™è¯¯ | é‡è¯•æˆ–è·³è¿‡ |

**å¹³å°é”™è¯¯ç (æŠ–éŸ³):**

| é”™è¯¯ç  | å«ä¹‰ | å¤„ç†æ–¹æ³• |
|--------|------|----------|
| 0 | æˆåŠŸ | æ­£å¸¸å¤„ç† |
| 2154 | éœ€è¦éªŒè¯ | æ‰‹åŠ¨è¿‡éªŒè¯ |
| 2155 | IPè¢«å° | æ›´æ¢IP |
| 10000 | å‚æ•°é”™è¯¯ | æ£€æŸ¥è¯·æ±‚å‚æ•° |

### 5.3 é”™è¯¯æ—¥å¿—

**æ—¥å¿—ä½ç½®:** æ§åˆ¶å°è¾“å‡º(æœªå†™å…¥æ–‡ä»¶)

**æ—¥å¿—çº§åˆ«:**
```python
import logging

# è®¾ç½®æ—¥å¿—çº§åˆ«
logging.basicConfig(level=logging.INFO)

# æ—¥å¿—è¾“å‡º
utils.logger.info("æ­£å¸¸ä¿¡æ¯")
utils.logger.warning("è­¦å‘Šä¿¡æ¯")
utils.logger.error("é”™è¯¯ä¿¡æ¯")
```

**å¦‚ä½•å¯ç”¨æ–‡ä»¶æ—¥å¿—:**

```python
# åœ¨main.pyæˆ–gui_app.pyå¼€å¤´æ·»åŠ 
import logging

logging.basicConfig(
    level=logging.INFO,
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',
    handlers=[
        logging.FileHandler('crawler.log', encoding='utf-8'),
        logging.StreamHandler()
    ]
)
```

---

## 6. è°ƒè¯•æŒ‡å— â­â­

### 6.1 å¦‚ä½•å¼€å¯è°ƒè¯•æ¨¡å¼

**æ–¹æ³•1: ä¿®æ”¹é…ç½®æ–‡ä»¶**

```python
# config/base_config.py
HEADLESS = False  # æ˜¾ç¤ºæµè§ˆå™¨,å¯ä»¥çœ‹åˆ°é‡‡é›†è¿‡ç¨‹
```

**æ–¹æ³•2: ä½¿ç”¨VSCodeè°ƒè¯•**

```json
// .vscode/launch.json
{
    "version": "0.2.0",
    "configurations": [
        {
            "name": "Python: GUI",
            "type": "python",
            "request": "launch",
            "program": "${workspaceFolder}/start_gui.py",
            "console": "integratedTerminal",
            "justMyCode": false
        }
    ]
}
```

**æ–¹æ³•3: æ·»åŠ æ–­ç‚¹**

```python
# åœ¨å…³é”®ä½ç½®æ·»åŠ æ–­ç‚¹
import pdb; pdb.set_trace()

# æˆ–ä½¿ç”¨breakpoint()(Python 3.7+)
breakpoint()
```

### 6.2 å¦‚ä½•æŸ¥çœ‹ç½‘ç»œè¯·æ±‚

**æ–¹æ³•1: æµè§ˆå™¨å¼€å‘è€…å·¥å…·**

```python
# å¯åŠ¨æµè§ˆå™¨æ—¶ä¸è¦ä½¿ç”¨æ— å¤´æ¨¡å¼
HEADLESS = False

# æ‰‹åŠ¨æ‰“å¼€å¼€å‘è€…å·¥å…·(F12)
# åˆ‡æ¢åˆ°Networkæ ‡ç­¾
# æŸ¥çœ‹æ‰€æœ‰ç½‘ç»œè¯·æ±‚
```

**æ–¹æ³•2: Playwrightç½‘ç»œç›‘å¬**

```python
# åœ¨æµè§ˆå™¨åˆ›å»ºåæ·»åŠ 
async def log_request(request):
    print(f"â†’ {request.method} {request.url}")

async def log_response(response):
    print(f"â† {response.status} {response.url}")

page.on("request", log_request)
page.on("response", log_response)
```

### 6.3 å¸¸è§è°ƒè¯•åœºæ™¯

**åœºæ™¯1: ç™»å½•å¤±è´¥**

```
è°ƒè¯•æ­¥éª¤:
1. è®¾ç½® HEADLESS = False
2. è¿è¡Œç¨‹åº,ç‚¹å‡»"ç™»å½•"
3. è§‚å¯Ÿæµè§ˆå™¨è¡Œä¸º
4. æ£€æŸ¥æ˜¯å¦æœ‰éªŒè¯ç 
5. æ£€æŸ¥æ˜¯å¦éœ€è¦æ‰‹æœºå·éªŒè¯
6. æŸ¥çœ‹æ§åˆ¶å°é”™è¯¯ä¿¡æ¯
```

**åœºæ™¯2: é‡‡é›†æ•°æ®ä¸ºç©º**

```
è°ƒè¯•æ­¥éª¤:
1. æ£€æŸ¥ç™»å½•çŠ¶æ€
2. æ£€æŸ¥å…³é”®è¯æ˜¯å¦æ­£ç¡®
3. æ£€æŸ¥å¹³å°æ˜¯å¦æœ‰æ•°æ®
4. æŸ¥çœ‹ç½‘ç»œè¯·æ±‚æ˜¯å¦æˆåŠŸ
5. æŸ¥çœ‹æ•°æ®è§£ææ˜¯å¦æ­£ç¡®
6. æ£€æŸ¥æ–‡ä»¶æ˜¯å¦ç”Ÿæˆ
```

**åœºæ™¯3: ç¨‹åºå¡ä½ä¸åŠ¨**

```
è°ƒè¯•æ­¥éª¤:
1. æŸ¥çœ‹æ§åˆ¶å°æœ€åä¸€æ¡æ—¥å¿—
2. æ£€æŸ¥æ˜¯å¦åœ¨ç­‰å¾…ç½‘ç»œè¯·æ±‚
3. æ£€æŸ¥æ˜¯å¦åœ¨ç­‰å¾…ç”¨æˆ·æ“ä½œ
4. ä½¿ç”¨Ctrl+Cä¸­æ–­,æŸ¥çœ‹å †æ ˆ
5. æ·»åŠ è¶…æ—¶æœºåˆ¶
```

### 6.4 æ€§èƒ½åˆ†æ

**å¦‚ä½•æµ‹é‡é‡‡é›†é€Ÿåº¦:**

```python
import time

start_time = time.time()

# æ‰§è¡Œé‡‡é›†
await crawler.start()

end_time = time.time()
elapsed_time = end_time - start_time

print(f"é‡‡é›†è€—æ—¶: {elapsed_time:.2f}ç§’")
print(f"å¹³å‡æ¯ä¸ªè§†é¢‘: {elapsed_time / video_count:.2f}ç§’")
```

**æ€§èƒ½åŸºå‡†(å‚è€ƒ):**

| æ“ä½œ | è€—æ—¶ |
|------|------|
| å¯åŠ¨æµè§ˆå™¨ | 3-5ç§’ |
| ç™»å½•(æ‰«ç ) | 10-30ç§’ |
| æœç´¢å…³é”®è¯ | 2-3ç§’ |
| è·å–è§†é¢‘è¯¦æƒ… | 1-2ç§’ |
| è·å–50æ¡è¯„è®º | 5-10ç§’ |
| æ€»è®¡(10ä¸ªè§†é¢‘) | 60-120ç§’ |

---

## 7. å¹³å°å·®å¼‚è¯´æ˜ â­

### 7.1 å››ä¸ªå¹³å°çš„æŠ€æœ¯å·®å¼‚

**æŠ–éŸ³(dy):**
- APIåŠ å¯†: æœ‰(éœ€è¦ç­¾å)
- åçˆ¬å¼ºåº¦: é«˜
- ç™»å½•æ–¹å¼: æ‰«ç 
- æ•°æ®ç»“æ„: å¤æ‚
- ç‰¹æ®Šå¤„ç†: éœ€è¦å¤„ç†æ»‘åŠ¨éªŒè¯

**å°çº¢ä¹¦(xhs):**
- APIåŠ å¯†: æœ‰(éœ€è¦ç­¾å)
- åçˆ¬å¼ºåº¦: å¾ˆé«˜
- ç™»å½•æ–¹å¼: æ‰«ç 
- æ•°æ®ç»“æ„: å¤æ‚
- ç‰¹æ®Šå¤„ç†: éœ€è¦å¤„ç†æ»‘åŠ¨éªŒè¯ã€å›¾ç‰‡éªŒè¯

**Bç«™(bili):**
- APIåŠ å¯†: æ— 
- åçˆ¬å¼ºåº¦: ä¸­
- ç™»å½•æ–¹å¼: æ‰«ç /å¯†ç 
- æ•°æ®ç»“æ„: ç®€å•
- ç‰¹æ®Šå¤„ç†: éœ€è¦å¤„ç†åˆ†Pè§†é¢‘

**çŸ¥ä¹(zhihu):**
- APIåŠ å¯†: æ— 
- åçˆ¬å¼ºåº¦: ä½
- ç™»å½•æ–¹å¼: æ‰«ç /å¯†ç 
- æ•°æ®ç»“æ„: ç®€å•
- ç‰¹æ®Šå¤„ç†: éœ€è¦å¤„ç†æ–‡ç« /å›ç­”/æƒ³æ³•

### 7.2 å¹³å°ç‰¹å®šé€»è¾‘

**æŠ–éŸ³:**
```python
# media_platform/douyin/core.py
# ç‰¹æ®Šå¤„ç†: è§†é¢‘IDæå–
def extract_aweme_id(video_url: str) -> str:
    """ä»URLæå–è§†é¢‘ID"""
    # æ”¯æŒå¤šç§URLæ ¼å¼
    # https://www.douyin.com/video/7123456789
    # https://v.douyin.com/xxx/
    pass
```

**å°çº¢ä¹¦:**
```python
# media_platform/xhs/core.py
# ç‰¹æ®Šå¤„ç†: ç¬”è®°ç±»å‹åˆ¤æ–­
def get_note_type(note_info: dict) -> str:
    """åˆ¤æ–­ç¬”è®°ç±»å‹"""
    # å›¾æ–‡ç¬”è®° vs è§†é¢‘ç¬”è®°
    if note_info.get('type') == 'video':
        return 'video'
    else:
        return 'normal'
```

**Bç«™:**
```python
# media_platform/bilibili/core.py
# ç‰¹æ®Šå¤„ç†: BVå·è½¬AVå·
def bv_to_av(bv: str) -> int:
    """BVå·è½¬AVå·"""
    pass
```

**çŸ¥ä¹:**
```python
# media_platform/zhihu/core.py
# ç‰¹æ®Šå¤„ç†: å†…å®¹ç±»å‹åˆ¤æ–­
def get_content_type(url: str) -> str:
    """åˆ¤æ–­å†…å®¹ç±»å‹"""
    # é—®é¢˜/æ–‡ç« /æƒ³æ³•
    if '/question/' in url:
        return 'question'
    elif '/p/' in url:
        return 'article'
    else:
        return 'pin'
```

---

## 8. æ•°æ®åº“æ”¯æŒ(å¯é€‰) â­

### 8.1 æ•°æ®åº“é…ç½®

**æ”¯æŒçš„æ•°æ®åº“:**
- SQLite(æœ¬åœ°)
- MySQL(è¿œç¨‹)
- PostgreSQL(è¿œç¨‹)

**é…ç½®æ–¹æ³•:**

```python
# config/db_config.py
RELATION_DB_PWD = "your_password"
RELATION_DB_URL = f"mysql://root:{RELATION_DB_PWD}@localhost:3306/media_crawler"

# æˆ–ä½¿ç”¨SQLite
RELATION_DB_URL = "sqlite:///media_crawler.db"
```

**å¯ç”¨æ•°æ®åº“:**

```python
# config/base_config.py
SAVE_DATA_OPTION = "db"  # æˆ– "sqlite"
```

### 8.2 æ•°æ®åº“è¡¨ç»“æ„

**æŠ–éŸ³è§†é¢‘è¡¨(douyin_aweme):**

```sql
CREATE TABLE douyin_aweme (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    aweme_id VARCHAR(64) UNIQUE NOT NULL,
    title VARCHAR(500),
    desc TEXT,
    create_time BIGINT,
    user_id VARCHAR(64),
    nickname VARCHAR(64),
    avatar VARCHAR(500),
    liked_count INT,
    comment_count INT,
    share_count INT,
    video_url VARCHAR(500),
    add_ts BIGINT,
    last_modify_ts BIGINT
);
```

**æŠ–éŸ³è¯„è®ºè¡¨(douyin_aweme_comment):**

```sql
CREATE TABLE douyin_aweme_comment (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    comment_id VARCHAR(64) UNIQUE NOT NULL,
    aweme_id VARCHAR(64) NOT NULL,
    content TEXT,
    create_time BIGINT,
    user_id VARCHAR(64),
    nickname VARCHAR(64),
    avatar VARCHAR(500),
    liked_count INT,
    reply_count INT,
    parent_comment_id VARCHAR(64),
    add_ts BIGINT,
    last_modify_ts BIGINT,
    FOREIGN KEY (aweme_id) REFERENCES douyin_aweme(aweme_id)
);
```

### 8.3 æ•°æ®åº“åˆå§‹åŒ–

```bash
# åˆå§‹åŒ–æ•°æ®åº“è¡¨
python main.py --init_db

# æˆ–æ‰‹åŠ¨æ‰§è¡ŒSQL
mysql -u root -p media_crawler < schema/tables.sql
```

---

## 9. æ€»ç»“:æ–°å¼€å‘è€…å¿«é€Ÿä¸Šæ‰‹æ£€æŸ¥æ¸…å•

### ç¯å¢ƒæ­å»º âœ…
- [ ] Python 3.8+å·²å®‰è£…
- [ ] ä¾èµ–åŒ…å·²å®‰è£…(`pip install -r requirements.txt`)
- [ ] Playwrightæµè§ˆå™¨å·²å®‰è£…(`playwright install chromium`)
- [ ] GUIèƒ½æ­£å¸¸å¯åŠ¨(`python start_gui.py`)

### é…ç½®ç†è§£ âœ…
- [ ] ç†è§£é…ç½®æ–‡ä»¶å’ŒGUIçš„å…³ç³»
- [ ] ç†è§£CDPæ¨¡å¼çš„ä½œç”¨
- [ ] çŸ¥é“å¦‚ä½•ä¿®æ”¹é…ç½®

### æ ¸å¿ƒé€»è¾‘ç†è§£ âœ…
- [ ] ç†è§£æµè§ˆå™¨å®ä¾‹ç”Ÿå‘½å‘¨æœŸ
- [ ] ç†è§£ç™»å½•çŠ¶æ€ç®¡ç†
- [ ] ç†è§£æ•°æ®æµå‘
- [ ] ç†è§£å¼‚æ­¥ç¼–ç¨‹æ¶æ„
- [ ] ç†è§£æ–‡ä»¶å‘½åè§„åˆ™

### è°ƒè¯•èƒ½åŠ› âœ…
- [ ] çŸ¥é“å¦‚ä½•å¼€å¯è°ƒè¯•æ¨¡å¼
- [ ] çŸ¥é“å¦‚ä½•æŸ¥çœ‹ç½‘ç»œè¯·æ±‚
- [ ] çŸ¥é“å¦‚ä½•æ·»åŠ æ—¥å¿—
- [ ] çŸ¥é“å¦‚ä½•å¤„ç†å¸¸è§é”™è¯¯

### å¼€å‘èƒ½åŠ› âœ…
- [ ] çŸ¥é“å¦‚ä½•æ·»åŠ æ–°å¹³å°
- [ ] çŸ¥é“å¦‚ä½•ä¿®æ”¹æ–‡ä»¶å‘½å
- [ ] çŸ¥é“å¦‚ä½•æ·»åŠ æ–°åŠŸèƒ½
- [ ] çŸ¥é“å¦‚ä½•æµ‹è¯•éªŒè¯

**å®Œæˆä»¥ä¸Šæ£€æŸ¥æ¸…å•,ä½ å°±å¯ä»¥å¿«é€Ÿæ¥æ‰‹è¿™ä¸ªé¡¹ç›®äº†!** ğŸ‰

---

## ğŸ“ æœ€ä½³å®è·µ

### ä»£ç è§„èŒƒ

#### 1. å‘½åè§„èŒƒ
```python
# ç±»å: å¤§é©¼å³°
class MediaCrawlerGUI:
    pass

# å‡½æ•°å: å°å†™+ä¸‹åˆ’çº¿
def start_crawling():
    pass

# å¸¸é‡: å¤§å†™+ä¸‹åˆ’çº¿
MAX_RETRY_COUNT = 3

# å˜é‡: å°å†™+ä¸‹åˆ’çº¿
video_count = 10
```

#### 2. æ³¨é‡Šè§„èŒƒ
```python
def crawl_video(video_id: str) -> Dict:
    """
    é‡‡é›†å•ä¸ªè§†é¢‘çš„è¯„è®º

    Args:
        video_id: è§†é¢‘ID

    Returns:
        åŒ…å«è¯„è®ºæ•°æ®çš„å­—å…¸

    Raises:
        TimeoutError: é‡‡é›†è¶…æ—¶
        LoginError: ç™»å½•å¤±æ•ˆ
    """
    pass
```

#### 3. é”™è¯¯å¤„ç†
```python
# å…·ä½“å¼‚å¸¸ä¼˜å…ˆ
try:
    await crawl()
except TimeoutError:
    logger.error("é‡‡é›†è¶…æ—¶")
    retry()
except LoginError:
    logger.error("ç™»å½•å¤±æ•ˆ")
    re_login()
except Exception as e:
    logger.error(f"æœªçŸ¥é”™è¯¯: {e}")
```

### Gitå·¥ä½œæµ

#### åˆ†æ”¯ç®¡ç†
```
main          - ç¨³å®šç‰ˆæœ¬
â”œâ”€ develop    - å¼€å‘ç‰ˆæœ¬
â”œâ”€ feature/*  - åŠŸèƒ½åˆ†æ”¯
â”œâ”€ bugfix/*   - Bugä¿®å¤åˆ†æ”¯
â””â”€ hotfix/*   - ç´§æ€¥ä¿®å¤åˆ†æ”¯
```

#### æäº¤æµç¨‹
```bash
# 1. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
git checkout -b feature/new-feature

# 2. å¼€å‘å¹¶æäº¤
git add .
git commit -m "feat: æ·»åŠ æ–°åŠŸèƒ½"

# 3. æ¨é€åˆ°è¿œç¨‹
git push origin feature/new-feature

# 4. åˆ›å»ºPull Request
# åœ¨GitHubä¸Šåˆ›å»ºPR,ç­‰å¾…å®¡æ ¸

# 5. åˆå¹¶åˆ°main
git checkout main
git merge feature/new-feature
git push origin main
```

### æµ‹è¯•ç­–ç•¥

#### å•å…ƒæµ‹è¯•
```python
# tests/test_file_writer.py
import unittest
from tools.async_file_writer import AsyncFileWriter

class TestAsyncFileWriter(unittest.TestCase):
    def test_file_naming(self):
        writer = AsyncFileWriter("douyin", "search")
        # æµ‹è¯•æ–‡ä»¶å‘½åé€»è¾‘
        pass
```

#### é›†æˆæµ‹è¯•
```python
# tests/test_crawler.py
async def test_douyin_crawler():
    # æµ‹è¯•å®Œæ•´é‡‡é›†æµç¨‹
    crawler = DouyinCrawler()
    await crawler.login()
    result = await crawler.search("æµ‹è¯•")
    assert len(result) > 0
```

---

**æ–‡æ¡£ç»“æŸ**

*æœ€åæ›´æ–°: 2025-11-03*
*ç‰ˆæœ¬: V1.2.4*
*ä½œè€…: yufeng*
*GitHub: https://github.com/InterestWatcher-Xiaofeng/-*

