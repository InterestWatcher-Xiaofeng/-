# 🍁 红枫工具箱 - 社交媒体评论采集工具

[![Version](https://img.shields.io/badge/version-V1.1.0-blue.svg)](https://github.com/InterestWatcher-Xiaofeng/MediaCrawler)
[![Python](https://img.shields.io/badge/python-3.8+-green.svg)](https://www.python.org/)
[![License](https://img.shields.io/badge/license-MIT-orange.svg)](LICENSE)

一款功能强大、简单易用的社交媒体评论采集工具，支持多个主流平台的数据采集。

## ✨ 主要特性

### 🎯 核心功能
- ✅ **多平台支持**：抖音、小红书、快手、B站、微博、贴吧、知乎
- ✅ **图形界面**：基于CustomTkinter的现代化GUI
- ✅ **一键登录**：自动保存和恢复登录状态
- ✅ **智能采集**：严格遵守用户设置的采集数量
- ✅ **多种格式**：支持CSV、JSON、Excel等多种输出格式

### 🚀 V1.1.0 新特性
- 🎉 **浏览器驱动自动化**：一键安装Playwright浏览器驱动
- 🔧 **智能检测**：自动检测驱动状态，首次运行自动提示安装
- 💪 **增强容错**：登录失败自动重试3次，网络超时自动处理
- 📦 **打包优化**：修复资源文件路径问题，支持EXE独立运行
- 💬 **友好提示**：根据错误类型提供具体的解决建议

## 📦 快速开始

### 方式一：直接使用EXE（推荐）

1. **下载最新版本**
   - 前往 [Releases](https://github.com/InterestWatcher-Xiaofeng/MediaCrawler/releases) 页面
   - 下载 `红枫工具箱-V1.1.0.zip`
   - 解压到任意目录

2. **首次运行**
   - 双击 `红枫工具箱.exe`
   - 看到浏览器驱动提示时，点击"是"自动安装
   - 等待2-5分钟完成安装（约200MB）

3. **开始使用**
   - 登录管理 → 选择平台 → 开始登录
   - 平台配置 → 设置关键词和数量
   - 数据输出 → 选择格式 → 开始采集

### 方式二：从源码运行

1. **克隆仓库**
   ```bash
   git clone https://github.com/InterestWatcher-Xiaofeng/MediaCrawler.git
   cd MediaCrawler/MediaCrawler
   ```

2. **安装依赖**
   ```bash
   pip install -r requirements.txt
   playwright install chromium
   ```

3. **运行程序**
   ```bash
   python gui_app.py
   ```

## 🎮 使用指南

### 1️⃣ 登录平台

1. 切换到"**登录管理**"标签页
2. 检查"**浏览器驱动状态**"
   - ✅ 已安装：可以直接使用
   - ❌ 未安装：点击"📥 安装驱动"按钮
3. 选择要登录的平台（如：抖音）
4. 点击"**开始登录**"按钮
5. 在弹出的浏览器中完成登录
6. 等待60秒自动保存登录状态

### 2️⃣ 配置采集参数

1. 切换到"**平台配置**"标签页
2. 选择采集模式：
   - 🔍 关键词搜索
   - 👤 用户主页
   - 🔥 热门推荐
3. 设置采集参数：
   - 关键词：如"美食"
   - 视频数量：10个
   - 每个视频评论数：50条

### 3️⃣ 开始采集

1. 切换到"**数据输出**"标签页
2. 选择输出格式：
   - 📄 JSON文件
   - 📊 CSV文件
   - 📈 Excel文件
3. 点击"**🚀 开始采集**"按钮
4. 等待采集完成
5. 自动打开结果文件

## 🛠️ 技术栈

- **GUI框架**：CustomTkinter
- **浏览器自动化**：Playwright
- **数据处理**：Pandas
- **打包工具**：PyInstaller
- **Python版本**：3.8+

## 📊 支持的平台

| 平台 | 状态 | 功能 |
|------|------|------|
| 🎵 抖音 | ✅ 完整支持 | 关键词搜索、用户主页、评论采集 |
| 📕 小红书 | ✅ 完整支持 | 关键词搜索、用户主页、评论采集 |
| 🎬 快手 | ✅ 完整支持 | 关键词搜索、用户主页、评论采集 |
| 📺 B站 | ✅ 完整支持 | 关键词搜索、用户主页、评论采集 |
| 🐦 微博 | ✅ 完整支持 | 关键词搜索、用户主页、评论采集 |
| 💬 贴吧 | ✅ 完整支持 | 关键词搜索、帖子采集 |
| 🤔 知乎 | ✅ 完整支持 | 关键词搜索、问题采集 |

## 🔧 常见问题

### Q1: 浏览器驱动安装失败？
**A:** 
- 检查网络连接
- 关闭杀毒软件和防火墙
- 手动运行：`playwright install chromium`

### Q2: 登录失败或超时？
**A:**
- 软件会自动重试3次
- 检查网络连接
- 尝试关闭VPN或代理
- 在浏览器中手动刷新页面

### Q3: 采集数据不完整？
**A:**
- 确认已完成平台登录
- 减少采集数量进行测试
- 增加采集间隔时间

### Q4: 打包后的EXE无法运行？
**A:**
- 确保已安装浏览器驱动
- 检查杀毒软件是否拦截
- 查看详细错误日志

## 📝 更新日志

### V1.1.0 (2025-10-25) - 浏览器驱动自动化版
- 🎉 新增：浏览器驱动自动检测和一键安装
- 🔧 修复：资源文件路径问题
- 💪 优化：登录错误处理和自动重试
- 💬 改进：友好的错误提示信息

### V1.0.0 (2025-10-26) - 正式发布版
- 🎉 正式发布
- ✅ 完整的评论采集功能
- ✅ 图形界面优化

[查看完整更新日志](MediaCrawler/version.py)

## 📄 许可证

本项目采用 MIT 许可证 - 详见 [LICENSE](LICENSE) 文件

## ⚠️ 免责声明

本工具仅供学习和研究使用，请勿用于商业用途。使用本工具时请遵守相关平台的服务条款和法律法规。

## 🤝 贡献

欢迎提交Issue和Pull Request！

## 📧 联系方式

- GitHub: [@InterestWatcher-Xiaofeng](https://github.com/InterestWatcher-Xiaofeng)
- Email: 158789466+InterestWatcher-Xiaofeng@users.noreply.github.com

---

⭐ 如果这个项目对你有帮助，请给个Star支持一下！

